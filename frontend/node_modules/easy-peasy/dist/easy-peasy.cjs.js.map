{"version":3,"file":"easy-peasy.cjs.js","sources":["../src/context.js","../src/lib.js","../src/hooks.js","../src/constants.js","../src/helpers.js","../src/create-store-internals.js","../src/create-store.js","../src/create-context-store.js","../src/create-component-store.js","../src/provider.js","../src/index.js"],"sourcesContent":["import { createContext } from 'react';\n\nconst StoreContext = createContext();\n\nexport default StoreContext;\n","export const isStateObject = x =>\n  x !== null && typeof x === 'object' && !Array.isArray(x);\n\nexport const get = (path, target) =>\n  path.reduce(\n    (acc, cur) => (isStateObject(acc) ? acc[cur] : undefined),\n    target,\n  );\n\nexport const set = (path, target, value) => {\n  path.reduce((acc, cur, idx) => {\n    if (idx + 1 === path.length) {\n      acc[cur] = value;\n    } else {\n      acc[cur] = acc[cur] || {};\n    }\n    return acc[cur];\n  }, target);\n};\n","import { useState, useEffect, useContext, useRef } from 'react';\nimport shallowEqual from 'shallowequal';\nimport EasyPeasyContext from './context';\nimport { isStateObject } from './lib';\n\nexport function createStoreStateHook(Context) {\n  return function useStoreState(mapState, dependencies = []) {\n    const store = useContext(Context);\n    const [state, setState] = useState(() => mapState(store.getState()));\n    const [error, setError] = useState(null);\n    // As our effect only fires on mount and unmount it won't have the state\n    // changes visible to it, therefore we use a mutable ref to track this.\n    const stateRef = useRef(state);\n    // Helps avoid firing of events when unsubscribed, i.e. unmounted\n    const isActive = useRef(true);\n    // Tracks when a hooked component is unmounting\n    const unmounted = useRef(false);\n    // Throwing the error inline allows error boundaries the opportunity to\n    // catch the error\n    if (error) {\n      throw error;\n    }\n    useEffect(() => {\n      isActive.current = true;\n      const calculateState = () => {\n        if (!isActive.current) {\n          return;\n        }\n        try {\n          const newState = mapState(store.getState());\n          if (\n            newState === stateRef.current ||\n            (isStateObject(newState) &&\n              isStateObject(stateRef.current) &&\n              shallowEqual(newState, stateRef.current))\n          ) {\n            // Do nothing\n            return;\n          }\n          stateRef.current = newState;\n          setState(() => stateRef.current);\n        } catch (err) {\n          // see https://github.com/reduxjs/react-redux/issues/1179\n          // There is a possibility mapState will fail as the props/state that\n          // the component has received is stale. Therefore we will afford the\n          // application a small window of opportunity, where if they unmount\n          // the component or provide it with new \"valid\" props (which will\n          // subsequently cause a refreshed subscription cycle) then we will not\n          // throw an error.\n          // This is by no means a robust solution. We should track the\n          // associated issue in the hope for a more dependable solution.\n\n          // Setting the listener as \"inactive\", this can only be changed if the\n          // incoming dependencies are different (i.e. props have changed)\n          isActive.current = false;\n\n          setTimeout(() => {\n            if (!unmounted.current && !isActive.current) {\n              setError(err);\n            }\n          }, 200); // give a window of opportunity\n        }\n      };\n      calculateState();\n      const unsubscribe = store.subscribe(calculateState);\n      return () => {\n        isActive.current = false;\n        unsubscribe();\n      };\n    }, dependencies);\n\n    // This effect will set the ref value to indicate that the component has\n    // unmounted\n    useEffect(() => {\n      return () => {\n        unmounted.current = true;\n      };\n    }, []);\n    return state;\n  };\n}\n\nexport const useStoreState = createStoreStateHook(EasyPeasyContext);\n\nexport function createStoreActionsHook(Context) {\n  return function useStoreActions(mapActions) {\n    const store = useContext(Context);\n    return mapActions(store.dispatch);\n  };\n}\n\nexport const useStoreActions = createStoreActionsHook(EasyPeasyContext);\n\nexport function createStoreDispatchHook(Context) {\n  return function useStoreDispatch() {\n    const store = useContext(Context);\n    return store.dispatch;\n  };\n}\n\nexport const useStoreDispatch = createStoreDispatchHook(EasyPeasyContext);\n\nconst wrapWithWarning = (prev, next, useImp) => {\n  let warned = false;\n  return function useDeprecated(...args) {\n    if (process.env.NODE_ENV !== 'production' && !warned) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        `easy-peasy: The \"${prev}\" hook has been deprecated. Please replace all instances with the \"${next}\" hook.`,\n      );\n      warned = true;\n    }\n    return useImp(...args);\n  };\n};\n\nexport const useActions = wrapWithWarning(\n  'useActions',\n  'useStoreActions',\n  useStoreActions,\n);\n\nexport const useDispatch = wrapWithWarning(\n  'useDispatch',\n  'useStoreDispatch',\n  useStoreDispatch,\n);\n\nexport const useStore = wrapWithWarning(\n  'useStore',\n  'useStoreState',\n  useStoreState,\n);\n\nexport function createTypedHooks() {\n  return {\n    useActions,\n    useDispatch,\n    useStore,\n    useStoreActions,\n    useStoreDispatch,\n    useStoreState,\n  };\n}\n","export const actionNameSymbol = 'ðŸ™ˆactionNameðŸ™ˆ';\nexport const actionSymbol = 'ðŸ™ˆactionðŸ™ˆ';\nexport const actionStateSymbol = 'ðŸ™ˆactionStateðŸ™ˆ';\n\nexport const computedSymbol = 'ðŸ™ˆcomputedSymbolðŸ™ˆ';\nexport const computedConfigSymbol = 'ðŸ™ˆcomputedConfigSymbolðŸ™ˆ';\n\nexport const listenSymbol = 'ðŸ™ˆlistenðŸ™ˆ';\n\nexport const metaSymbol = 'ðŸ™ˆmetaðŸ™ˆ';\n\nexport const reducerSymbol = 'ðŸ™ˆreducerðŸ™ˆ';\n\nexport const selectDependenciesSymbol = 'ðŸ™ˆselectDependenciesðŸ™ˆ';\nexport const selectImpSymbol = 'ðŸ™ˆselectImpðŸ™ˆ';\nexport const selectStateSymbol = 'ðŸ™ˆselectStateðŸ™ˆ';\nexport const selectSymbol = 'ðŸ™ˆselectðŸ™ˆ';\n\nexport const selectorSymbol = 'ðŸ™ˆselectorðŸ™ˆ';\nexport const selectorConfigSymbol = 'ðŸ™ˆselectorConfigðŸ™ˆ';\nexport const selectorStateSymbol = 'ðŸ™ˆselectorStateðŸ™ˆ';\n\nexport const thunkSymbol = 'ðŸ™ˆthunkðŸ™ˆ';\nexport const thunkStateSymbol = 'ðŸ™ˆthunkStateðŸ™ˆ';\n","import { isDraft, finishDraft, createDraft } from 'immer-peasy';\nimport memoizerific from 'memoizerific';\nimport {\n  actionNameSymbol,\n  actionStateSymbol,\n  actionSymbol,\n  computedSymbol,\n  computedConfigSymbol,\n  listenSymbol,\n  reducerSymbol,\n  selectDependenciesSymbol,\n  selectorConfigSymbol,\n  selectorSymbol,\n  selectStateSymbol,\n  selectSymbol,\n  thunkStateSymbol,\n  thunkSymbol,\n} from './constants';\n\nexport const actionName = action => action[actionNameSymbol];\n\nexport const debug = state => {\n  if (isDraft(state)) {\n    const final = finishDraft(createDraft(state));\n    return final;\n  }\n  return state;\n};\n\nexport const thunkStartName = action => `${action[actionNameSymbol]}(started)`;\n\nexport const thunkCompleteName = action =>\n  `${action[actionNameSymbol]}(completed)`;\n\nexport const thunkFailName = action => `${action[actionNameSymbol]}(failed)`;\n\nexport const action = (fn, config) => {\n  fn[actionSymbol] = true;\n  fn[actionStateSymbol] = {\n    config,\n  };\n  return fn;\n};\n\nconst defaultStateResolvers = [state => state];\n\nexport const computed = (fn, stateResolvers = defaultStateResolvers) => {\n  fn[computedSymbol] = true;\n  fn[computedConfigSymbol] = {\n    stateResolvers,\n  };\n  return fn;\n};\n\nexport const listen = fn => {\n  fn[listenSymbol] = true;\n  return fn;\n};\n\nexport const memo = (fn, cacheSize) => memoizerific(cacheSize)(fn);\n\nexport const thunk = (fn, config) => {\n  fn[thunkSymbol] = true;\n  fn[thunkStateSymbol] = {\n    config,\n  };\n  return fn;\n};\n\nexport const select = (fn, dependencies) => {\n  fn[selectSymbol] = true;\n  fn[selectDependenciesSymbol] = dependencies;\n  fn[selectStateSymbol] = {};\n  return fn;\n};\n\nexport const selector = (args, fn, config) => {\n  fn[selectorSymbol] = true;\n  fn[selectorConfigSymbol] = {\n    args,\n    config,\n  };\n  return fn;\n};\n\nexport const reducer = fn => {\n  fn[reducerSymbol] = true;\n  return fn;\n};\n","import memoizerific from 'memoizerific';\nimport produce from 'immer-peasy';\nimport {\n  actionNameSymbol,\n  actionStateSymbol,\n  actionSymbol,\n  computedSymbol,\n  computedConfigSymbol,\n  listenSymbol,\n  metaSymbol,\n  reducerSymbol,\n  selectDependenciesSymbol,\n  selectImpSymbol,\n  selectorConfigSymbol,\n  selectorStateSymbol,\n  selectorSymbol,\n  selectStateSymbol,\n  selectSymbol,\n  thunkStateSymbol,\n  thunkSymbol,\n} from './constants';\nimport { isStateObject, get, set } from './lib';\nimport * as helpers from './helpers';\n\nconst maxSelectFnMemoize = 100;\nconst tick = () => new Promise(resolve => setTimeout(resolve));\n\nconst errorToPayload = err => {\n  if (err instanceof Error) {\n    return {\n      message: err.message,\n      stack: err.stack,\n    };\n  }\n  if (typeof err === 'string') {\n    return err;\n  }\n  return undefined;\n};\n\nexport default function createStoreInternals({\n  disableInternalSelectFnMemoize,\n  initialState,\n  injections,\n  model,\n  reducerEnhancer,\n  references,\n}) {\n  let isInReducer = false;\n\n  const wrapFnWithMemoize = x =>\n    !disableInternalSelectFnMemoize && typeof x === 'function'\n      ? memoizerific(maxSelectFnMemoize)(x)\n      : x;\n\n  const defaultState = initialState || {};\n  let selectorId = 0;\n\n  const computedProperties = {};\n\n  const actionCreatorDict = {};\n  const actionCreators = {};\n\n  const actionListenersDict = {};\n\n  const actionReducersDict = {};\n  const actionReducersForPath = {};\n\n  const actionThunks = {};\n\n  const customReducers = [];\n\n  const listenDefinitions = [];\n\n  const listenerActionDefinitions = [];\n  const listenerActionMap = {};\n  const listenerThunkMap = {};\n\n  const selectorsDict = {};\n  const selectorReducers = [];\n\n  const thunkListenersDict = {};\n\n  const recursiveExtractDefsFromModel = (current, parentPath) =>\n    Object.keys(current).forEach(key => {\n      const value = current[key];\n      const path = [...parentPath, key];\n      const meta = {\n        parent: parentPath,\n        path,\n      };\n      if (typeof value === 'function') {\n        if (value[actionSymbol]) {\n          const name = `@action.${path.join('.')}`;\n          value[actionNameSymbol] = name;\n          value[metaSymbol] = meta;\n\n          // Action Reducer\n          const actionReducer = value;\n          actionReducer[actionNameSymbol] = name;\n          actionReducersDict[name] = actionReducer;\n          actionReducersForPath[parentPath] = actionReducer;\n\n          // Action Creator\n          const actionCreator = payload => {\n            const result = references.dispatch({\n              type: actionReducer[actionNameSymbol],\n              payload,\n            });\n            return result;\n          };\n          actionCreator[actionNameSymbol] = name;\n          actionCreatorDict[name] = actionCreator;\n          set(path, actionCreators, actionCreator);\n\n          const { config } = value[actionStateSymbol];\n          if (config && config.listenTo) {\n            listenerActionDefinitions.push(value);\n          }\n        } else if (value[thunkSymbol]) {\n          const name = `@thunk.${path.join('.')}`;\n          value[actionNameSymbol] = name;\n\n          // Thunk Action\n          const action = payload => {\n            return value(get(parentPath, actionCreators), payload, {\n              // @deprecated\n              dispatch: references.dispatch,\n              getState: () => get(parentPath, references.getState()),\n              getStoreActions: () => actionCreators,\n              getStoreState: references.getState,\n              injections,\n              meta,\n            });\n          };\n          set(path, actionThunks, action);\n\n          // Thunk Action Creator\n          const actionCreator = payload =>\n            tick()\n              .then(() =>\n                references.dispatch({\n                  type: `${name}(started)`,\n                  payload,\n                }),\n              )\n              .then(() => references.dispatch(() => action(payload)))\n              .then(result => {\n                references.dispatch({\n                  type: `${name}(completed)`,\n                  payload,\n                });\n                return result;\n              })\n              .catch(err => {\n                references.dispatch({\n                  type: `${name}(failed)`,\n                  payload,\n                  error: errorToPayload(err),\n                });\n                throw err;\n              });\n\n          actionCreator[actionNameSymbol] = name;\n          actionCreatorDict[name] = actionCreator;\n          set(path, actionCreators, actionCreator);\n\n          const { config } = value[thunkStateSymbol];\n          if (config && config.listenTo) {\n            listenerActionDefinitions.push(value);\n          }\n        } else if (value[computedSymbol]) {\n          let target = get(parentPath, defaultState);\n          if (!target) {\n            target = {};\n            set(parentPath, defaultState, target);\n          }\n          const config = value[computedConfigSymbol];\n          const { stateResolvers } = config;\n          const memoisedResultFn = memoizerific(1)(value);\n          let cache;\n          const createComputedProperty = o => {\n            Object.defineProperty(o, key, {\n              configurable: true,\n              get: () => {\n                const storeState = isInReducer\n                  ? references.currentState\n                  : references.getState();\n                const state = get(parentPath, storeState);\n                const inputs = stateResolvers.map(resolver =>\n                  resolver(state, storeState),\n                );\n                cache = memoisedResultFn(...inputs);\n                return cache;\n              },\n              set: () => {\n                throw new Error(\n                  `Easy Peasy: You attempted to set \"${path.join(\n                    '.',\n                  )}\", which is a computed property set a computed property`,\n                );\n              },\n            });\n          };\n          createComputedProperty(target);\n          set(path, computedProperties, createComputedProperty);\n        } else if (value[selectorSymbol]) {\n          selectorId += 1;\n          const selectorInstanceId = selectorId;\n          const { args, config } = value[selectorConfigSymbol];\n          const stateSelectors =\n            args && Array.isArray(args)\n              ? args.map(s => memoizerific(1)(s))\n              : [state => state];\n          const limit =\n            typeof config === 'object' &&\n            typeof config.limit === 'number' &&\n            config.limit > 0\n              ? config.number\n              : 1;\n          const internalSelector = memoizerific(limit)((...a) =>\n            value(\n              a.slice(0, stateSelectors.length),\n              a.slice(stateSelectors.length),\n            ),\n          );\n          let changeIdx = 0;\n\n          /**\n           * This allows us to track whether the state we are depending on\n           * (resolved via the state selectors), has changed. If so then we know\n           * that we should create a new instance of our selector function so\n           * that updates are propagated and memoization caches are cleared.\n           */\n          const createDependentStateChangeTracker = () => {\n            const internalChecker = memoizerific(1)(() => {\n              changeIdx += 1;\n              return changeIdx;\n            });\n            const dependentStateChangeTracker = storeState => {\n              const localState = get(parentPath, storeState);\n              const resolvedStateArgs = stateSelectors.reduce(\n                (acc, argSelector) => {\n                  acc.push(argSelector(localState, storeState));\n                  return acc;\n                },\n                [],\n              );\n              return internalChecker(...resolvedStateArgs);\n            };\n            return dependentStateChangeTracker;\n          };\n\n          /**\n           * We create a function allowing us to create new selector instances.\n           * We will need this ability to reinitialise a selector of the state\n           * it depends on changes.\n           */\n          const createSelector = () => {\n            const selector = (...runtimeArgs) => {\n              const storeState = references.getState();\n              const localState = get(parentPath, storeState);\n              const selectedStateArgs = stateSelectors.reduce(\n                (acc, argSelector) => [\n                  ...acc,\n                  argSelector(localState, storeState),\n                ],\n                [],\n              );\n              return internalSelector(...selectedStateArgs.concat(runtimeArgs));\n            };\n            selector[selectorStateSymbol] = {\n              dependentStateChangeTracker: createDependentStateChangeTracker(),\n              createSelector,\n              meta,\n              selectorId: selectorInstanceId,\n            };\n            return selector;\n          };\n          const selector = createSelector();\n          selectorsDict[selectorId] = selector;\n          set(path, defaultState, selector);\n        } else if (value[selectSymbol]) {\n          value[selectStateSymbol] = { parentPath, key, executed: false };\n          selectorReducers.push(value);\n        } else if (value[reducerSymbol]) {\n          customReducers.push({ path, reducer: value });\n        } else if (value[listenSymbol]) {\n          listenDefinitions.push(value);\n          value[metaSymbol] = meta;\n        } else if (process.env.NODE_ENV !== 'production') {\n          // eslint-disable-next-line no-console\n          console.warn(\n            `easy-peasy: Found a function at path ${path.join(\n              '.',\n            )} in your model. Version 2 required that you wrap your action functions with the \"action\" helper`,\n          );\n        }\n      } else if (isStateObject(value) && Object.keys(value).length > 0) {\n        const existing = get(path, defaultState);\n        if (existing == null) {\n          set(path, defaultState, {});\n        }\n        recursiveExtractDefsFromModel(value, path);\n      } else {\n        // State\n        const initialParentRef = get(parentPath, initialState);\n        if (initialParentRef && key in initialParentRef) {\n          set(path, defaultState, initialParentRef[key]);\n        } else {\n          set(path, defaultState, value);\n        }\n      }\n    });\n\n  recursiveExtractDefsFromModel(model, []);\n\n  listenerActionDefinitions.forEach(listenerAction => {\n    const {\n      config: { listenTo },\n    } = listenerAction[actionStateSymbol] || listenerAction[thunkStateSymbol];\n    let targetName;\n\n    const processListenTo = target => {\n      if (\n        typeof target === 'function' &&\n        target[actionNameSymbol] &&\n        actionCreatorDict[target[actionNameSymbol]]\n      ) {\n        if (target[thunkSymbol]) {\n          targetName = helpers.thunkCompleteName(target);\n        } else {\n          targetName = target[actionNameSymbol];\n        }\n      } else if (typeof target === 'string') {\n        targetName = target;\n      }\n      const listenerReg = listenerActionMap[targetName] || [];\n      listenerReg.push(actionCreatorDict[listenerAction[actionNameSymbol]]);\n      listenerActionMap[targetName] = listenerReg;\n    };\n\n    if (Array.isArray(listenTo)) {\n      listenTo.forEach(processListenTo);\n    } else {\n      processListenTo(listenTo);\n    }\n  });\n\n  selectorReducers.forEach(selector => {\n    selector[selectImpSymbol] = state => wrapFnWithMemoize(selector(state));\n  });\n\n  listenDefinitions.forEach(def => {\n    def.listeners = def.listeners || {};\n\n    const on = (target, handler) => {\n      if (typeof handler !== 'function') {\n        return;\n      }\n\n      const meta = def[metaSymbol];\n      handler[metaSymbol] = meta;\n\n      if (!handler[actionSymbol] && !handler[thunkSymbol]) {\n        if (process.env.NODE_ENV !== 'production') {\n          // eslint-disable-next-line\n          console.warn(\n            `easy-peasy: you must provide either an \"action\" or \"thunk\" to your listeners. Found an invalid handler at \"${meta.path.join(\n              '.',\n            )}\"`,\n          );\n        }\n        return;\n      }\n\n      let targetActionName;\n\n      if (\n        typeof target === 'function' &&\n        target[actionNameSymbol] &&\n        actionCreatorDict[target[actionNameSymbol]]\n      ) {\n        if (target[thunkSymbol]) {\n          targetActionName = helpers.thunkCompleteName(target);\n        } else {\n          targetActionName = target[actionNameSymbol];\n        }\n      } else if (typeof target === 'string') {\n        targetActionName = target;\n      }\n\n      if (targetActionName) {\n        if (handler[thunkSymbol]) {\n          thunkListenersDict[targetActionName] =\n            thunkListenersDict[targetActionName] || [];\n          thunkListenersDict[targetActionName].push(handler);\n        } else {\n          actionListenersDict[targetActionName] =\n            actionListenersDict[targetActionName] || [];\n          actionListenersDict[targetActionName].push({\n            path: meta.parent,\n            handler,\n          });\n        }\n        def.listeners[targetActionName] = def.listeners[targetActionName] || [];\n        def.listeners[targetActionName].push(handler);\n      }\n    };\n    def(on);\n  });\n\n  const runSelectorReducer = (state, selector) => {\n    const { parentPath, key, executed } = selector[selectStateSymbol];\n    if (executed) {\n      return state;\n    }\n    const dependencies = selector[selectDependenciesSymbol];\n\n    const stateAfterDependencies = dependencies\n      ? dependencies.reduce(runSelectorReducer, state)\n      : state;\n\n    let newState = stateAfterDependencies;\n\n    if (parentPath.length > 0) {\n      const target = get(parentPath, stateAfterDependencies);\n      if (target) {\n        if (\n          !selector.prevState ||\n          selector.prevState !== get(parentPath, state)\n        ) {\n          const newValue = selector[selectImpSymbol](target);\n          newState = produce(state, draft => {\n            const updateTarget = get(parentPath, draft);\n            updateTarget[key] = newValue;\n          });\n          selector.prevState = get(parentPath, newState);\n        }\n      }\n    } else if (!selector.prevState || selector.prevState !== state) {\n      const newValue = selector[selectImpSymbol](stateAfterDependencies);\n      newState = produce(state, draft => {\n        draft[key] = newValue;\n      });\n      selector.prevState = newState;\n    }\n\n    selector[selectStateSymbol].executed = true;\n    return newState;\n  };\n\n  const runSelectors = state =>\n    selectorReducers.reduce(runSelectorReducer, state);\n\n  const createReducer = () => {\n    const runActionReducerAtPath = (state, action, actionReducer, path) => {\n      const current = get(path, state);\n      const updatedState =\n        path.length === 0\n          ? produce(state, _draft => actionReducer(_draft, action.payload))\n          : produce(state, draft => {\n              set(\n                actionReducer[metaSymbol].parent,\n                draft,\n                produce(current, _draft =>\n                  actionReducer(_draft, action.payload),\n                ),\n              );\n            });\n\n      if (updatedState !== state) {\n        const computedPropertyCreators = get(path, computedProperties);\n        if (computedPropertyCreators) {\n          const updatedCurrent = get(path, updatedState);\n          Object.keys(computedPropertyCreators).forEach(key => {\n            computedPropertyCreators[key](updatedCurrent);\n          });\n        }\n      }\n\n      return updatedState;\n    };\n\n    const reducerForActions = (state, action) => {\n      const actionReducer = actionReducersDict[action.type];\n      if (actionReducer) {\n        return runActionReducerAtPath(\n          state,\n          action,\n          actionReducer,\n          actionReducer[metaSymbol].parent,\n        );\n      }\n      return state;\n    };\n\n    const reducerForListeners = (state, action) => {\n      const target =\n        action.type === '@@EP/LISTENER' ? action.actionName : action.type;\n      const actionListeners = actionListenersDict[target];\n      if (actionListeners) {\n        const targetAction =\n          action.type === '@@EP/LISTENER'\n            ? { type: target, payload: action.payload }\n            : action;\n        return actionListeners.reduce(\n          (newState, { path, handler }) =>\n            runActionReducerAtPath(newState, targetAction, handler, path),\n          state,\n        );\n      }\n      return state;\n    };\n\n    const reducerForCustomReducers = (state, action) => {\n      return produce(state, draft => {\n        customReducers.forEach(({ path: p, reducer: red }) => {\n          const current = get(p, draft);\n          set(p, draft, red(current, action));\n        });\n      });\n    };\n\n    let isInitial = true;\n\n    const selectsReducer = state => {\n      const stateAfterSelectors = runSelectors(state);\n      isInitial = false;\n      selectorReducers.forEach(selector => {\n        selector[selectStateSymbol].executed = false;\n      });\n      return stateAfterSelectors;\n    };\n\n    const selectorsReducer = state => {\n      const selectors = Object.values(selectorsDict);\n      return produce(state, draft => {\n        selectors.forEach(selector => {\n          const selectorState = selector[selectorStateSymbol];\n          if (selectorState.prevStateCheckId == null) {\n            selectorState.prevStateCheckId = selectorState.dependentStateChangeTracker(\n              state,\n            );\n          } else {\n            const nextStateCheckId = selectorState.dependentStateChangeTracker(\n              state,\n            );\n            if (selectorState.prevStateCheckId !== nextStateCheckId) {\n              const newSelector = selectorState.createSelector();\n              newSelector[selectorState.prevStateCheckId] = nextStateCheckId;\n              selectorsDict[selectorState.selectorId] = newSelector;\n              set(selectorState.meta.path, draft, newSelector);\n            }\n          }\n        });\n      });\n    };\n\n    const rootReducer = (state, action) => {\n      isInReducer = true;\n      const stateAfterActions = reducerForActions(state, action);\n      const stateAfterListeners = reducerForListeners(\n        stateAfterActions,\n        action,\n      );\n      const stateAfterCustomReducers = reducerForCustomReducers(\n        stateAfterListeners,\n        action,\n      );\n      const stateAfterSelect =\n        state !== stateAfterCustomReducers || isInitial\n          ? selectsReducer(stateAfterCustomReducers)\n          : stateAfterCustomReducers;\n      const result = selectorsReducer(stateAfterSelect);\n      isInReducer = false;\n      return result;\n    };\n\n    return rootReducer;\n  };\n\n  return {\n    actionCreators,\n    actionListenersDict,\n    defaultState,\n    listenDefinitions,\n    listenerActionMap,\n    listenerThunkMap,\n    reducer: reducerEnhancer(createReducer()),\n    thunkListenersDict,\n  };\n}\n","import {\n  applyMiddleware,\n  compose as reduxCompose,\n  createStore as reduxCreateStore,\n} from 'redux';\nimport reduxThunk from 'redux-thunk';\nimport { get } from './lib';\nimport { metaSymbol, actionSymbol, thunkSymbol } from './constants';\nimport * as helpers from './helpers';\nimport createStoreInternals from './create-store-internals';\nimport { useStoreActions, useStoreDispatch, useStoreState } from './hooks';\n\nexport default function createStore(model, options = {}) {\n  const {\n    compose,\n    devTools = true,\n    disableInternalSelectFnMemoize = false,\n    enhancers = [],\n    initialState = {},\n    injections,\n    middleware = [],\n    mockActions = false,\n    name: storeName = `EasyPeasyStore`,\n    reducerEnhancer = rootReducer => rootReducer,\n  } = options;\n\n  const modelDefinition = {\n    ...model,\n    logFullState: helpers.thunk((actions, payload, { getState }) => {\n      // eslint-disable-next-line no-console\n      console.log(JSON.stringify(getState(), null, 2));\n    }),\n    replaceState: helpers.action((state, payload) => payload),\n  };\n\n  const references = {};\n\n  let mockedActions = [];\n\n  const dispatchThunk = (thunk, payload) =>\n    thunk(\n      get(thunk[metaSymbol].parent, references.internals.actionCreators),\n      payload,\n      {\n        dispatch: references.dispatch,\n        getState: () => get(thunk[metaSymbol].parent, references.getState()),\n        getStoreState: references.getState,\n        injections,\n        meta: thunk[metaSymbol],\n      },\n    );\n\n  const dispatchThunkListeners = (name, payload) => {\n    const listensForAction = references.internals.thunkListenersDict[name];\n    return listensForAction && listensForAction.length > 0\n      ? Promise.all(\n          listensForAction.map(listenForAction =>\n            dispatchThunk(listenForAction, payload),\n          ),\n        )\n      : Promise.resolve();\n  };\n\n  const dispatchActionStringListeners = () => next => action => {\n    const result = next(action);\n    if (references.internals.thunkListenersDict[action.type]) {\n      dispatchThunkListeners(action.type, action.payload);\n    }\n    return result;\n  };\n\n  const composeEnhancers =\n    compose ||\n    (devTools &&\n    typeof window !== 'undefined' &&\n    window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n      ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({\n          name: storeName,\n        })\n      : reduxCompose);\n\n  const bindStoreInternals = state => {\n    references.internals = createStoreInternals({\n      disableInternalSelectFnMemoize,\n      initialState: state,\n      injections,\n      model: modelDefinition,\n      reducerEnhancer,\n      references,\n    });\n  };\n\n  bindStoreInternals(initialState);\n\n  const listenerActionsMiddleware = () => next => action => {\n    const result = next(action);\n    if (\n      action &&\n      references.internals.listenerActionMap[action.type] &&\n      references.internals.listenerActionMap[action.type].length > 0\n    ) {\n      references.internals.listenerActionMap[action.type].forEach(\n        actionCreator => {\n          actionCreator(action.payload);\n        },\n      );\n    }\n    return result;\n  };\n\n  const mockActionsMiddleware = () => next => action => {\n    if (mockActions) {\n      if (\n        action == null ||\n        (typeof action === 'object' && action.type === '@@EP/LISTENER')\n      ) {\n        // DO NOTHING\n      } else {\n        mockedActions.push(action);\n      }\n      return undefined;\n    }\n    return next(action);\n  };\n\n  const currentStateMiddleware = () => next => action => {\n    references.currentState = references.getState();\n    return next(action);\n  };\n\n  const store = reduxCreateStore(\n    references.internals.reducer,\n    references.internals.defaultState,\n    composeEnhancers(\n      applyMiddleware(\n        reduxThunk,\n        dispatchActionStringListeners,\n        ...middleware,\n        listenerActionsMiddleware,\n        currentStateMiddleware,\n        mockActionsMiddleware,\n      ),\n      ...enhancers,\n    ),\n  );\n\n  store.getMockedActions = () => [...mockedActions];\n  store.clearMockedActions = () => {\n    mockedActions = [];\n  };\n\n  references.dispatch = store.dispatch;\n  references.getState = store.getState;\n\n  // attach the action creators to dispatch\n  const bindActionCreators = actionCreators => {\n    Object.keys(store.dispatch).forEach(actionsKey => {\n      delete store.dispatch[actionsKey];\n    });\n    Object.keys(actionCreators).forEach(key => {\n      store.dispatch[key] = actionCreators[key];\n    });\n    store.getActions = () => actionCreators;\n  };\n\n  bindActionCreators(references.internals.actionCreators);\n\n  const rebindStore = removeKey => {\n    const currentState = store.getState();\n    if (removeKey) {\n      delete currentState[removeKey];\n    }\n    bindStoreInternals(store.getState());\n    store.replaceReducer(references.internals.reducer);\n    store.dispatch.replaceState(references.internals.defaultState);\n    bindActionCreators(references.internals.actionCreators);\n  };\n\n  store.addModel = (key, modelForKey) => {\n    if (modelDefinition[key] && process.env.NODE_ENV !== 'production') {\n      // eslint-disable-next-line no-console\n      console.warn(\n        `easy-peasy: The store model already contains a model definition for \"${key}\"`,\n      );\n      store.removeModel(key);\n    }\n    modelDefinition[key] = modelForKey;\n    rebindStore();\n  };\n\n  store.removeModel = key => {\n    if (!modelDefinition[key]) {\n      if (process.env.NODE_ENV !== 'production') {\n        // eslint-disable-next-line no-console\n        console.warn(\n          `easy-peasy: The store model does not contain a model definition for \"${key}\"`,\n        );\n      }\n      return;\n    }\n    delete modelDefinition[key];\n    rebindStore(key);\n  };\n\n  // @deprecated\n  const dispatchActionListener = (actionName, payload) =>\n    store.dispatch({\n      type: '@@EP/LISTENER',\n      payload,\n      actionName,\n    });\n\n  const resolveActionName = action =>\n    typeof action === 'function'\n      ? action[actionSymbol]\n        ? helpers.actionName(action)\n        : action[thunkSymbol]\n        ? helpers.thunkCompleteName(action)\n        : undefined\n      : typeof action === 'string'\n      ? action\n      : undefined;\n\n  // @deprecated\n  store.triggerListener = (listener, action, payload) => {\n    const actionName = resolveActionName(action);\n    if (\n      listener.listeners[actionName] &&\n      listener.listeners[actionName].length > 0\n    ) {\n      if (\n        listener.listeners[actionName].some(handler => handler[actionSymbol])\n      ) {\n        dispatchActionListener(actionName, payload);\n      }\n      const thunkHandlers = listener.listeners[actionName].filter(\n        handler => handler[thunkSymbol],\n      );\n      return thunkHandlers.length > 0\n        ? Promise.all(\n            thunkHandlers.map(handler => dispatchThunk(handler, payload)),\n          ).then(() => undefined)\n        : Promise.resolve();\n    }\n    return Promise.resolve();\n  };\n\n  // @deprecated\n  store.triggerListeners = (action, payload) => {\n    const actionName = resolveActionName(action);\n    if (actionName) {\n      const actionListenerHandlers =\n        references.internals.actionListenersDict[actionName];\n      if (actionListenerHandlers && actionListenerHandlers.length > 0) {\n        dispatchActionListener(actionName, payload);\n      }\n      const thunkListenerHandlers =\n        references.internals.thunkListenersDict[actionName];\n      return thunkListenerHandlers && thunkListenerHandlers.length > 0\n        ? Promise.all(\n            thunkListenerHandlers.map(handler =>\n              dispatchThunk(handler, payload),\n            ),\n          ).then(() => undefined)\n        : Promise.resolve();\n    }\n    return Promise.resolve();\n  };\n\n  store.useStoreActions = useStoreActions;\n  store.useStoreDispatch = useStoreDispatch;\n  store.useStoreState = useStoreState;\n\n  return store;\n}\n","/* eslint-disable react/prop-types */\n\nimport React, { createContext, useContext, useMemo } from 'react';\nimport {\n  createStoreActionsHook,\n  createStoreDispatchHook,\n  createStoreStateHook,\n} from './hooks';\nimport createStore from './create-store';\n\nexport default function createContextStore(model, config) {\n  const StoreContext = createContext();\n\n  function Provider({ children, initialData }) {\n    const store = useMemo(\n      () =>\n        createStore(\n          typeof model === 'function' ? model(initialData) : model,\n          config,\n        ),\n      [],\n    );\n    return (\n      <StoreContext.Provider value={store}>{children}</StoreContext.Provider>\n    );\n  }\n\n  function useStore() {\n    return useContext(StoreContext);\n  }\n\n  return {\n    Provider,\n    useStore,\n    useStoreState: createStoreStateHook(StoreContext),\n    useStoreActions: createStoreActionsHook(StoreContext),\n    useStoreDispatch: createStoreDispatchHook(StoreContext),\n  };\n}\n","import { useMemo, useState, useRef, useEffect } from 'react';\nimport createStore from './create-store';\n\n/**\n * Some good references on the topic of reinitialisation:\n * - https://github.com/facebook/react/issues/14830\n */\n\nexport default function createComponentStore(model, config) {\n  return function useLocalStore(initialData) {\n    const store = useMemo(\n      () =>\n        createStore(\n          typeof model === 'function' ? model(initialData) : model,\n          config,\n        ),\n      [],\n    );\n    const previousStateRef = useRef(store.getState());\n    const [currentState, setCurrentState] = useState(() => store.getState());\n    useEffect(() => {\n      return store.subscribe(() => {\n        const nextState = store.getState();\n        if (previousStateRef.current !== nextState) {\n          previousStateRef.current = nextState;\n          setCurrentState(nextState);\n        }\n      });\n    }, [store]);\n    return [currentState, store.dispatch];\n  };\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport StoreContext from './context';\n\nconst StoreProvider = ({ children, store }) => (\n  <StoreContext.Provider value={store}>{children}</StoreContext.Provider>\n);\n\nStoreProvider.propTypes = {\n  children: PropTypes.node.isRequired,\n  store: PropTypes.object.isRequired,\n};\n\nexport default StoreProvider;\n","import { setAutoFreeze } from 'immer-peasy';\nimport {\n  createTypedHooks,\n  useActions,\n  useDispatch,\n  useStore,\n  useStoreActions,\n  useStoreDispatch,\n  useStoreState,\n} from './hooks';\nimport createStore from './create-store';\nimport createContextStore from './create-context-store';\nimport createComponentStore from './create-component-store';\nimport StoreProvider from './provider';\nimport {\n  action,\n  actionName,\n  computed,\n  debug,\n  listen,\n  memo,\n  reducer,\n  select,\n  selector,\n  thunk,\n  thunkCompleteName,\n  thunkFailName,\n  thunkStartName,\n} from './helpers';\n\n/**\n * immer is an implementation detail, so we are not going to use its auto freeze\n * behaviour, which throws errors if trying to mutate state. It's also risky\n * for production builds as has a perf overhead.\n *\n * @see https://github.com/mweststrate/immer#auto-freezing\n */\nsetAutoFreeze(false);\n\nexport {\n  action,\n  actionName,\n  computed,\n  createContextStore,\n  createComponentStore,\n  createStore,\n  createTypedHooks,\n  debug,\n  listen,\n  memo,\n  reducer,\n  select,\n  selector,\n  StoreProvider,\n  thunk,\n  thunkCompleteName,\n  thunkFailName,\n  thunkStartName,\n  useActions,\n  useDispatch,\n  useStore,\n  useStoreActions,\n  useStoreDispatch,\n  useStoreState,\n};\n"],"names":["StoreContext","createContext","isStateObject","x","Array","isArray","get","path","target","reduce","acc","cur","undefined","set","value","idx","length","createStoreStateHook","Context","useStoreState","mapState","dependencies","store","useContext","useState","getState","state","setState","error","setError","stateRef","useRef","isActive","unmounted","useEffect","current","calculateState","newState","shallowEqual","err","setTimeout","unsubscribe","subscribe","EasyPeasyContext","createStoreActionsHook","useStoreActions","mapActions","dispatch","createStoreDispatchHook","useStoreDispatch","wrapWithWarning","prev","next","useImp","warned","useDeprecated","process","env","NODE_ENV","console","warn","useActions","useDispatch","useStore","createTypedHooks","actionNameSymbol","actionSymbol","actionStateSymbol","computedSymbol","computedConfigSymbol","listenSymbol","metaSymbol","reducerSymbol","selectDependenciesSymbol","selectImpSymbol","selectStateSymbol","selectSymbol","selectorSymbol","selectorConfigSymbol","selectorStateSymbol","thunkSymbol","thunkStateSymbol","actionName","action","debug","isDraft","final","finishDraft","createDraft","thunkStartName","thunkCompleteName","thunkFailName","fn","config","defaultStateResolvers","computed","stateResolvers","listen","memo","cacheSize","memoizerific","thunk","select","selector","args","reducer","maxSelectFnMemoize","tick","Promise","resolve","errorToPayload","Error","message","stack","createStoreInternals","disableInternalSelectFnMemoize","initialState","injections","model","reducerEnhancer","references","isInReducer","wrapFnWithMemoize","defaultState","selectorId","computedProperties","actionCreatorDict","actionCreators","actionListenersDict","actionReducersDict","actionThunks","customReducers","listenDefinitions","listenerActionDefinitions","listenerActionMap","listenerThunkMap","selectorsDict","selectorReducers","thunkListenersDict","recursiveExtractDefsFromModel","parentPath","Object","keys","forEach","key","meta","parent","name","join","actionReducer","actionReducersForPath","actionCreator","payload","result","type","listenTo","push","getStoreActions","getStoreState","then","catch","memoisedResultFn","cache","createComputedProperty","o","defineProperty","configurable","storeState","currentState","inputs","map","resolver","selectorInstanceId","stateSelectors","s","limit","number","internalSelector","a","slice","changeIdx","createDependentStateChangeTracker","internalChecker","dependentStateChangeTracker","localState","resolvedStateArgs","argSelector","createSelector","selectedStateArgs","runtimeArgs","concat","executed","existing","initialParentRef","listenerAction","targetName","processListenTo","helpers","listenerReg","def","listeners","on","handler","targetActionName","runSelectorReducer","stateAfterDependencies","prevState","newValue","produce","draft","updateTarget","runSelectors","createReducer","runActionReducerAtPath","updatedState","_draft","computedPropertyCreators","updatedCurrent","reducerForActions","reducerForListeners","actionListeners","targetAction","reducerForCustomReducers","p","red","isInitial","selectsReducer","stateAfterSelectors","selectorsReducer","selectors","values","selectorState","prevStateCheckId","nextStateCheckId","newSelector","rootReducer","stateAfterActions","stateAfterListeners","stateAfterCustomReducers","stateAfterSelect","createStore","options","compose","devTools","enhancers","middleware","mockActions","storeName","modelDefinition","logFullState","actions","log","JSON","stringify","replaceState","mockedActions","dispatchThunk","internals","dispatchThunkListeners","listensForAction","all","listenForAction","dispatchActionStringListeners","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","reduxCompose","bindStoreInternals","listenerActionsMiddleware","mockActionsMiddleware","currentStateMiddleware","reduxCreateStore","applyMiddleware","reduxThunk","getMockedActions","clearMockedActions","bindActionCreators","actionsKey","getActions","rebindStore","removeKey","replaceReducer","addModel","modelForKey","removeModel","dispatchActionListener","resolveActionName","triggerListener","listener","some","thunkHandlers","filter","triggerListeners","actionListenerHandlers","thunkListenerHandlers","createContextStore","Provider","children","initialData","useMemo","React","createComponentStore","useLocalStore","previousStateRef","setCurrentState","nextState","StoreProvider","setAutoFreeze"],"mappings":"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"}
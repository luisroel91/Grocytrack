!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("immer-peasy"),require("react"),require("redux"),require("redux-thunk"),require("memoizerific")):"function"==typeof define&&define.amd?define(["exports","immer-peasy","react","redux","redux-thunk","memoizerific"],t):t((e=e||self).EasyPeasy={},e.produce,e.React,e.Redux,e.ReduxThunk,e.memoizerific)}(this,function(e,t,d,M,I,J){"use strict";var S="default"in t?t.default:t,c="default"in d?d.default:d;I=I&&I.hasOwnProperty("default")?I.default:I,J=J&&J.hasOwnProperty("default")?J.default:J;var v=function(e,t,n,r){var i=n?n.call(r,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var o=Object.keys(e),u=Object.keys(t);if(o.length!==u.length)return!1;for(var c=Object.prototype.hasOwnProperty.bind(t),a=0;a<o.length;a++){var f=o[a];if(!c(f))return!1;var s=e[f],l=t[f];if(!1===(i=n?n.call(r,s,l,f):void 0)||void 0===i&&s!==l)return!1}return!0},r=d.createContext(),Y=function(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)},B=function(e,t){return e.reduce(function(e,t){return Y(e)?e[t]:void 0},t)},G=function(r,e,i){r.reduce(function(e,t,n){return n+1===r.length?e[t]=i:e[t]=e[t]||{},e[t]},e)};function n(p){return function(n,e){void 0===e&&(e=[]);var r=d.useContext(p),t=d.useState(function(){return n(r.getState())}),i=t[0],o=t[1],u=d.useState(null),c=u[0],a=u[1],f=d.useRef(i),s=d.useRef(!0),l=d.useRef(!1);if(c)throw c;return d.useEffect(function(){s.current=!0;var e=function(){if(s.current)try{var e=n(r.getState());if(e===f.current||Y(e)&&Y(f.current)&&v(e,f.current))return;f.current=e,o(function(){return f.current})}catch(e){s.current=!1,setTimeout(function(){l.current||s.current||a(e)},200)}};e();var t=r.subscribe(e);return function(){s.current=!1,t()}},e),d.useEffect(function(){return function(){l.current=!0}},[]),i}}var N=n(r);function a(t){return function(e){return e(d.useContext(t).dispatch)}}var R=a(r);function f(e){return function(){return d.useContext(e).dispatch}}var _=f(r),i=function(e,t,n){return function(){return n.apply(void 0,arguments)}},o=i(0,0,R),u=i(0,0,_),s=i(0,0,N);function L(){return(L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var K="ðŸ™ˆactionNameðŸ™ˆ",Q="ðŸ™ˆactionðŸ™ˆ",W="ðŸ™ˆactionStateðŸ™ˆ",Z="ðŸ™ˆcomputedSymbolðŸ™ˆ",$="ðŸ™ˆcomputedConfigSymbolðŸ™ˆ",ee="ðŸ™ˆlistenðŸ™ˆ",te="ðŸ™ˆmetaðŸ™ˆ",ne="ðŸ™ˆreducerðŸ™ˆ",y="ðŸ™ˆselectDependenciesðŸ™ˆ",m="ðŸ™ˆselectImpðŸ™ˆ",re="ðŸ™ˆselectStateðŸ™ˆ",ie="ðŸ™ˆselectðŸ™ˆ",oe="ðŸ™ˆselectorðŸ™ˆ",ue="ðŸ™ˆselectorConfigðŸ™ˆ",ce="ðŸ™ˆselectorStateðŸ™ˆ",ae="ðŸ™ˆthunkðŸ™ˆ",fe="ðŸ™ˆthunkStateðŸ™ˆ",z=function(e){return e[K]},se=function(e){return e[K]+"(completed)"},F=function(e,t){return e[Q]=!0,e[W]={config:t},e},l=[function(e){return e}],q=function(e,t){return e[ae]=!0,e[fe]={config:t},e},g=100,le=function(){return new Promise(function(e){return setTimeout(e)})},pe=function(e){return e instanceof Error?{message:e.message,stack:e.stack}:"string"==typeof e?e:void 0};function X(e){var r=e.disableInternalSelectFnMemoize,w=e.initialState,x=e.injections,t=e.model,n=e.reducerEnhancer,T=e.references,M=!1,I=w||{},N=0,R={},_={},L={},p={},z={},F={},q=[],X=[],U=[],i={},V={},H=[],o={};!function A(C,D){return Object.keys(C).forEach(function(t){var r=C[t],n=[].concat(D,[t]),i={parent:D,path:n};if("function"==typeof r)if(r[Q]){var e="@action."+n.join(".");r[K]=e,r[te]=i;var o=r;o[K]=e,z[e]=o;var u=function(e){return T.dispatch({type:o[K],payload:e})};_[u[K]=e]=u,G(n,L,u);var c=r[W].config;c&&c.listenTo&&U.push(r)}else if(r[ae]){var a="@thunk."+n.join(".");r[K]=a;var f=function(e){return r(B(D,L),e,{dispatch:T.dispatch,getState:function(){return B(D,T.getState())},getStoreActions:function(){return L},getStoreState:T.getState,injections:x,meta:i})};G(n,F,f);var s=function(t){return le().then(function(){return T.dispatch({type:a+"(started)",payload:t})}).then(function(){return T.dispatch(function(){return f(t)})}).then(function(e){return T.dispatch({type:a+"(completed)",payload:t}),e}).catch(function(e){throw T.dispatch({type:a+"(failed)",payload:t,error:pe(e)}),e})};_[s[K]=a]=s,G(n,L,s);var l=r[fe].config;l&&l.listenTo&&U.push(r)}else if(r[Z]){var p=B(D,I);p||G(D,I,p={});var d=r[$].stateResolvers,v=J(1)(r),h=function(e){Object.defineProperty(e,t,{configurable:!0,get:function(){var t=M?T.currentState:T.getState(),n=B(D,t),e=d.map(function(e){return e(n,t)});return v.apply(void 0,e)},set:function(){throw new Error('Easy Peasy: You attempted to set "'+n.join(".")+'", which is a computed property set a computed property')}})};h(p),G(n,R,h)}else if(r[oe]){var S=N+=1,y=r[ue],m=y.args,g=y.config,E=m&&Array.isArray(m)?m.map(function(e){return J(1)(e)}):[function(e){return e}],k="object"==typeof g&&"number"==typeof g.limit&&0<g.limit?g.number:1,b=J(k)(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r(t.slice(0,E.length),t.slice(E.length))}),P=0,O=function e(){var t,n=function(){for(var n=T.getState(),r=B(D,n),e=E.reduce(function(e,t){return[].concat(e,[t(r,n)])},[]),t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return b.apply(void 0,e.concat(i))};return n[ce]={dependentStateChangeTracker:(t=J(1)(function(){return P+=1}),function(n){var r=B(D,n),e=E.reduce(function(e,t){return e.push(t(r,n)),e},[]);return t.apply(void 0,e)}),createSelector:e,meta:i,selectorId:S},n}();V[N]=O,G(n,I,O)}else r[ie]?(r[re]={parentPath:D,key:t,executed:!1},H.push(r)):r[ne]?q.push({path:n,reducer:r}):r[ee]&&(X.push(r),r[te]=i);else if(Y(r)&&0<Object.keys(r).length)null==B(n,I)&&G(n,I,{}),A(r,n);else{var j=B(D,w);G(n,I,j&&t in j?j[t]:r)}})}(t,[]),U.forEach(function(n){var r,e=(n[W]||n[fe]).config.listenTo,t=function(e){"function"==typeof e&&e[K]&&_[e[K]]?r=e[ae]?se(e):e[K]:"string"==typeof e&&(r=e);var t=i[r]||[];t.push(_[n[K]]),i[r]=t};Array.isArray(e)?e.forEach(t):t(e)}),H.forEach(function(n){n[m]=function(e){return t=n(e),r||"function"!=typeof t?t:J(g)(t);var t}}),X.forEach(function(i){i.listeners=i.listeners||{};i(function(e,t){if("function"==typeof t){var n,r=i[te];t[te]=r,(t[Q]||t[ae])&&("function"==typeof e&&e[K]&&_[e[K]]?n=e[ae]?se(e):e[K]:"string"==typeof e&&(n=e),n&&(t[ae]?(o[n]=o[n]||[],o[n].push(t)):(p[n]=p[n]||[],p[n].push({path:r.parent,handler:t})),i.listeners[n]=i.listeners[n]||[],i.listeners[n].push(t)))}})});var d,v,h,u=function e(t,n){var r=n[re],i=r.parentPath,o=r.key;if(r.executed)return t;var u=n[y],c=u?u.reduce(e,t):t,a=c;if(0<i.length){var f=B(i,c);if(f&&(!n.prevState||n.prevState!==B(i,t))){var s=n[m](f);a=S(t,function(e){B(i,e)[o]=s}),n.prevState=B(i,a)}}else if(!n.prevState||n.prevState!==t){var l=n[m](c);a=S(t,function(e){e[o]=l}),n.prevState=a}return n[re].executed=!0,a};return{actionCreators:L,actionListenersDict:p,defaultState:I,listenDefinitions:X,listenerActionMap:i,listenerThunkMap:{},reducer:n((d=function(e,t,n,r){var i=B(r,e),o=0===r.length?S(e,function(e){return n(e,t.payload)}):S(e,function(e){G(n[te].parent,e,S(i,function(e){return n(e,t.payload)}))});if(o!==e){var u=B(r,R);if(u){var c=B(r,o);Object.keys(u).forEach(function(e){u[e](c)})}}return o},v=!0,h=function(e){var t,n=(t=e,H.reduce(u,t));return v=!1,H.forEach(function(e){e[re].executed=!1}),n},function(e,t){M=!0;var n,r,i,o,u,c,a=function(e,t){var n="@@EP/LISTENER"===t.type?t.actionName:t.type,r=p[n];if(r){var i="@@EP/LISTENER"===t.type?{type:n,payload:t.payload}:t;return r.reduce(function(e,t){var n=t.path,r=t.handler;return d(e,i,r,n)},e)}return e}((n=e,(i=z[(r=t).type])?d(n,r,i,i[te].parent):n),t),f=(o=t,S(a,function(i){q.forEach(function(e){var t=e.path,n=e.reducer,r=B(t,i);G(t,i,n(r,o))})})),s=e!==f||v?h(f):f,l=(u=s,c=Object.values(V),S(u,function(i){c.forEach(function(e){var t=e[ce];if(null==t.prevStateCheckId)t.prevStateCheckId=t.dependentStateChangeTracker(u);else{var n=t.dependentStateChangeTracker(u);if(t.prevStateCheckId!==n){var r=t.createSelector();r[t.prevStateCheckId]=n,V[t.selectorId]=r,G(t.meta.path,i,r)}}})}));return M=!1,l})),thunkListenersDict:o}}function p(e,t){void 0===t&&(t={});var n=t,r=n.compose,i=n.devTools,o=void 0===i||i,u=n.disableInternalSelectFnMemoize,c=void 0!==u&&u,a=n.enhancers,f=void 0===a?[]:a,s=n.initialState,l=void 0===s?{}:s,p=n.injections,d=n.middleware,v=void 0===d?[]:d,h=n.mockActions,S=void 0!==h&&h,y=n.name,m=void 0===y?"EasyPeasyStore":y,g=n.reducerEnhancer,E=void 0===g?function(e){return e}:g,k=L({},e,{logFullState:q(function(e,t,n){var r=n.getState;console.log(JSON.stringify(r(),null,2))}),replaceState:F(function(e,t){return t})}),b={},P=[],O=function(e,t){return e(B(e[te].parent,b.internals.actionCreators),t,{dispatch:b.dispatch,getState:function(){return B(e[te].parent,b.getState())},getStoreState:b.getState,injections:p,meta:e[te]})},j=r||(o&&"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({name:m}):M.compose),A=function(e){b.internals=X({disableInternalSelectFnMemoize:c,initialState:e,injections:p,model:k,reducerEnhancer:E,references:b})};A(l);var C=M.createStore(b.internals.reducer,b.internals.defaultState,j.apply(void 0,[M.applyMiddleware.apply(void 0,[I,function(){return function(o){return function(e){var t,n,r,i=o(e);return b.internals.thunkListenersDict[e.type]&&(t=e.type,n=e.payload,(r=b.internals.thunkListenersDict[t])&&0<r.length?Promise.all(r.map(function(e){return O(e,n)})):Promise.resolve()),i}}}].concat(v,[function(){return function(n){return function(t){var e=n(t);return t&&b.internals.listenerActionMap[t.type]&&0<b.internals.listenerActionMap[t.type].length&&b.internals.listenerActionMap[t.type].forEach(function(e){e(t.payload)}),e}}},function(){return function(t){return function(e){return b.currentState=b.getState(),t(e)}}},function(){return function(t){return function(e){if(!S)return t(e);null==e||"object"==typeof e&&"@@EP/LISTENER"===e.type||P.push(e)}}}]))].concat(f)));C.getMockedActions=function(){return[].concat(P)},C.clearMockedActions=function(){P=[]},b.dispatch=C.dispatch,b.getState=C.getState;var D=function(t){Object.keys(C.dispatch).forEach(function(e){delete C.dispatch[e]}),Object.keys(t).forEach(function(e){C.dispatch[e]=t[e]}),C.getActions=function(){return t}};D(b.internals.actionCreators);var w=function(e){var t=C.getState();e&&delete t[e],A(C.getState()),C.replaceReducer(b.internals.reducer),C.dispatch.replaceState(b.internals.defaultState),D(b.internals.actionCreators)};C.addModel=function(e,t){k[e],k[e]=t,w()},C.removeModel=function(e){k[e]&&(delete k[e],w(e))};var x=function(e,t){return C.dispatch({type:"@@EP/LISTENER",payload:t,actionName:e})},T=function(e){return"function"==typeof e?e[Q]?z(e):e[ae]?se(e):void 0:"string"==typeof e?e:void 0};return C.triggerListener=function(e,t,n){var r=T(t);if(e.listeners[r]&&0<e.listeners[r].length){e.listeners[r].some(function(e){return e[Q]})&&x(r,n);var i=e.listeners[r].filter(function(e){return e[ae]});return 0<i.length?Promise.all(i.map(function(e){return O(e,n)})).then(function(){}):Promise.resolve()}return Promise.resolve()},C.triggerListeners=function(e,t){var n=T(e);if(n){var r=b.internals.actionListenersDict[n];r&&0<r.length&&x(n,t);var i=b.internals.thunkListenersDict[n];return i&&0<i.length?Promise.all(i.map(function(e){return O(e,t)})).then(function(){}):Promise.resolve()}return Promise.resolve()},C.useStoreActions=R,C.useStoreDispatch=_,C.useStoreState=N,C}t.setAutoFreeze(!1),e.StoreProvider=function(e){var t=e.children,n=e.store;return c.createElement(r.Provider,{value:n},t)},e.action=F,e.actionName=z,e.computed=function(e,t){return void 0===t&&(t=l),e[Z]=!0,e[$]={stateResolvers:t},e},e.createComponentStore=function(u,c){return function(e){var t=d.useMemo(function(){return p("function"==typeof u?u(e):u,c)},[]),n=d.useRef(t.getState()),r=d.useState(function(){return t.getState()}),i=r[0],o=r[1];return d.useEffect(function(){return t.subscribe(function(){var e=t.getState();n.current!==e&&(n.current=e,o(e))})},[t]),[i,t.dispatch]}},e.createContextStore=function(i,o){var u=d.createContext();return{Provider:function(e){var t=e.children,n=e.initialData,r=d.useMemo(function(){return p("function"==typeof i?i(n):i,o)},[]);return c.createElement(u.Provider,{value:r},t)},useStore:function(){return d.useContext(u)},useStoreState:n(u),useStoreActions:a(u),useStoreDispatch:f(u)}},e.createStore=p,e.createTypedHooks=function(){return{useActions:o,useDispatch:u,useStore:s,useStoreActions:R,useStoreDispatch:_,useStoreState:N}},e.debug=function(e){return t.isDraft(e)?t.finishDraft(t.createDraft(e)):e},e.listen=function(e){return e[ee]=!0,e},e.memo=function(e,t){return J(t)(e)},e.reducer=function(e){return e[ne]=!0,e},e.select=function(e,t){return e[ie]=!0,e[y]=t,e[re]={},e},e.selector=function(e,t,n){return t[oe]=!0,t[ue]={args:e,config:n},t},e.thunk=q,e.thunkCompleteName=se,e.thunkFailName=function(e){return e[K]+"(failed)"},e.thunkStartName=function(e){return e[K]+"(started)"},e.useActions=o,e.useDispatch=u,e.useStore=s,e.useStoreActions=R,e.useStoreDispatch=_,e.useStoreState=N,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=easy-peasy.umd.js.map

{"version":3,"file":"easy-peasy.umd.development.js","sources":["../node_modules/shallowequal/index.js","../src/context.js","../src/lib.js","../src/hooks.js","../src/constants.js","../src/helpers.js","../src/create-store-internals.js","../src/create-store.js","../src/create-context-store.js","../src/create-component-store.js","../src/provider.js","../src/index.js"],"sourcesContent":["//\n\nmodule.exports = function shallowEqual(objA, objB, compare, compareContext) {\n  var ret = compare ? compare.call(compareContext, objA, objB) : void 0;\n\n  if (ret !== void 0) {\n    return !!ret;\n  }\n\n  if (objA === objB) {\n    return true;\n  }\n\n  if (typeof objA !== \"object\" || !objA || typeof objB !== \"object\" || !objB) {\n    return false;\n  }\n\n  var keysA = Object.keys(objA);\n  var keysB = Object.keys(objB);\n\n  if (keysA.length !== keysB.length) {\n    return false;\n  }\n\n  var bHasOwnProperty = Object.prototype.hasOwnProperty.bind(objB);\n\n  // Test for A's keys different from B.\n  for (var idx = 0; idx < keysA.length; idx++) {\n    var key = keysA[idx];\n\n    if (!bHasOwnProperty(key)) {\n      return false;\n    }\n\n    var valueA = objA[key];\n    var valueB = objB[key];\n\n    ret = compare ? compare.call(compareContext, valueA, valueB, key) : void 0;\n\n    if (ret === false || (ret === void 0 && valueA !== valueB)) {\n      return false;\n    }\n  }\n\n  return true;\n};\n","import { createContext } from 'react';\n\nconst StoreContext = createContext();\n\nexport default StoreContext;\n","export const isStateObject = x =>\n  x !== null && typeof x === 'object' && !Array.isArray(x);\n\nexport const get = (path, target) =>\n  path.reduce(\n    (acc, cur) => (isStateObject(acc) ? acc[cur] : undefined),\n    target,\n  );\n\nexport const set = (path, target, value) => {\n  path.reduce((acc, cur, idx) => {\n    if (idx + 1 === path.length) {\n      acc[cur] = value;\n    } else {\n      acc[cur] = acc[cur] || {};\n    }\n    return acc[cur];\n  }, target);\n};\n","import { useState, useEffect, useContext, useRef } from 'react';\nimport shallowEqual from 'shallowequal';\nimport EasyPeasyContext from './context';\nimport { isStateObject } from './lib';\n\nexport function createStoreStateHook(Context) {\n  return function useStoreState(mapState, dependencies = []) {\n    const store = useContext(Context);\n    const [state, setState] = useState(() => mapState(store.getState()));\n    const [error, setError] = useState(null);\n    // As our effect only fires on mount and unmount it won't have the state\n    // changes visible to it, therefore we use a mutable ref to track this.\n    const stateRef = useRef(state);\n    // Helps avoid firing of events when unsubscribed, i.e. unmounted\n    const isActive = useRef(true);\n    // Tracks when a hooked component is unmounting\n    const unmounted = useRef(false);\n    // Throwing the error inline allows error boundaries the opportunity to\n    // catch the error\n    if (error) {\n      throw error;\n    }\n    useEffect(() => {\n      isActive.current = true;\n      const calculateState = () => {\n        if (!isActive.current) {\n          return;\n        }\n        try {\n          const newState = mapState(store.getState());\n          if (\n            newState === stateRef.current ||\n            (isStateObject(newState) &&\n              isStateObject(stateRef.current) &&\n              shallowEqual(newState, stateRef.current))\n          ) {\n            // Do nothing\n            return;\n          }\n          stateRef.current = newState;\n          setState(() => stateRef.current);\n        } catch (err) {\n          // see https://github.com/reduxjs/react-redux/issues/1179\n          // There is a possibility mapState will fail as the props/state that\n          // the component has received is stale. Therefore we will afford the\n          // application a small window of opportunity, where if they unmount\n          // the component or provide it with new \"valid\" props (which will\n          // subsequently cause a refreshed subscription cycle) then we will not\n          // throw an error.\n          // This is by no means a robust solution. We should track the\n          // associated issue in the hope for a more dependable solution.\n\n          // Setting the listener as \"inactive\", this can only be changed if the\n          // incoming dependencies are different (i.e. props have changed)\n          isActive.current = false;\n\n          setTimeout(() => {\n            if (!unmounted.current && !isActive.current) {\n              setError(err);\n            }\n          }, 200); // give a window of opportunity\n        }\n      };\n      calculateState();\n      const unsubscribe = store.subscribe(calculateState);\n      return () => {\n        isActive.current = false;\n        unsubscribe();\n      };\n    }, dependencies);\n\n    // This effect will set the ref value to indicate that the component has\n    // unmounted\n    useEffect(() => {\n      return () => {\n        unmounted.current = true;\n      };\n    }, []);\n    return state;\n  };\n}\n\nexport const useStoreState = createStoreStateHook(EasyPeasyContext);\n\nexport function createStoreActionsHook(Context) {\n  return function useStoreActions(mapActions) {\n    const store = useContext(Context);\n    return mapActions(store.dispatch);\n  };\n}\n\nexport const useStoreActions = createStoreActionsHook(EasyPeasyContext);\n\nexport function createStoreDispatchHook(Context) {\n  return function useStoreDispatch() {\n    const store = useContext(Context);\n    return store.dispatch;\n  };\n}\n\nexport const useStoreDispatch = createStoreDispatchHook(EasyPeasyContext);\n\nconst wrapWithWarning = (prev, next, useImp) => {\n  let warned = false;\n  return function useDeprecated(...args) {\n    if (process.env.NODE_ENV !== 'production' && !warned) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        `easy-peasy: The \"${prev}\" hook has been deprecated. Please replace all instances with the \"${next}\" hook.`,\n      );\n      warned = true;\n    }\n    return useImp(...args);\n  };\n};\n\nexport const useActions = wrapWithWarning(\n  'useActions',\n  'useStoreActions',\n  useStoreActions,\n);\n\nexport const useDispatch = wrapWithWarning(\n  'useDispatch',\n  'useStoreDispatch',\n  useStoreDispatch,\n);\n\nexport const useStore = wrapWithWarning(\n  'useStore',\n  'useStoreState',\n  useStoreState,\n);\n\nexport function createTypedHooks() {\n  return {\n    useActions,\n    useDispatch,\n    useStore,\n    useStoreActions,\n    useStoreDispatch,\n    useStoreState,\n  };\n}\n","export const actionNameSymbol = 'ðŸ™ˆactionNameðŸ™ˆ';\nexport const actionSymbol = 'ðŸ™ˆactionðŸ™ˆ';\nexport const actionStateSymbol = 'ðŸ™ˆactionStateðŸ™ˆ';\n\nexport const computedSymbol = 'ðŸ™ˆcomputedSymbolðŸ™ˆ';\nexport const computedConfigSymbol = 'ðŸ™ˆcomputedConfigSymbolðŸ™ˆ';\n\nexport const listenSymbol = 'ðŸ™ˆlistenðŸ™ˆ';\n\nexport const metaSymbol = 'ðŸ™ˆmetaðŸ™ˆ';\n\nexport const reducerSymbol = 'ðŸ™ˆreducerðŸ™ˆ';\n\nexport const selectDependenciesSymbol = 'ðŸ™ˆselectDependenciesðŸ™ˆ';\nexport const selectImpSymbol = 'ðŸ™ˆselectImpðŸ™ˆ';\nexport const selectStateSymbol = 'ðŸ™ˆselectStateðŸ™ˆ';\nexport const selectSymbol = 'ðŸ™ˆselectðŸ™ˆ';\n\nexport const selectorSymbol = 'ðŸ™ˆselectorðŸ™ˆ';\nexport const selectorConfigSymbol = 'ðŸ™ˆselectorConfigðŸ™ˆ';\nexport const selectorStateSymbol = 'ðŸ™ˆselectorStateðŸ™ˆ';\n\nexport const thunkSymbol = 'ðŸ™ˆthunkðŸ™ˆ';\nexport const thunkStateSymbol = 'ðŸ™ˆthunkStateðŸ™ˆ';\n","import { isDraft, finishDraft, createDraft } from 'immer-peasy';\nimport memoizerific from 'memoizerific';\nimport {\n  actionNameSymbol,\n  actionStateSymbol,\n  actionSymbol,\n  computedSymbol,\n  computedConfigSymbol,\n  listenSymbol,\n  reducerSymbol,\n  selectDependenciesSymbol,\n  selectorConfigSymbol,\n  selectorSymbol,\n  selectStateSymbol,\n  selectSymbol,\n  thunkStateSymbol,\n  thunkSymbol,\n} from './constants';\n\nexport const actionName = action => action[actionNameSymbol];\n\nexport const debug = state => {\n  if (isDraft(state)) {\n    const final = finishDraft(createDraft(state));\n    return final;\n  }\n  return state;\n};\n\nexport const thunkStartName = action => `${action[actionNameSymbol]}(started)`;\n\nexport const thunkCompleteName = action =>\n  `${action[actionNameSymbol]}(completed)`;\n\nexport const thunkFailName = action => `${action[actionNameSymbol]}(failed)`;\n\nexport const action = (fn, config) => {\n  fn[actionSymbol] = true;\n  fn[actionStateSymbol] = {\n    config,\n  };\n  return fn;\n};\n\nconst defaultStateResolvers = [state => state];\n\nexport const computed = (fn, stateResolvers = defaultStateResolvers) => {\n  fn[computedSymbol] = true;\n  fn[computedConfigSymbol] = {\n    stateResolvers,\n  };\n  return fn;\n};\n\nexport const listen = fn => {\n  fn[listenSymbol] = true;\n  return fn;\n};\n\nexport const memo = (fn, cacheSize) => memoizerific(cacheSize)(fn);\n\nexport const thunk = (fn, config) => {\n  fn[thunkSymbol] = true;\n  fn[thunkStateSymbol] = {\n    config,\n  };\n  return fn;\n};\n\nexport const select = (fn, dependencies) => {\n  fn[selectSymbol] = true;\n  fn[selectDependenciesSymbol] = dependencies;\n  fn[selectStateSymbol] = {};\n  return fn;\n};\n\nexport const selector = (args, fn, config) => {\n  fn[selectorSymbol] = true;\n  fn[selectorConfigSymbol] = {\n    args,\n    config,\n  };\n  return fn;\n};\n\nexport const reducer = fn => {\n  fn[reducerSymbol] = true;\n  return fn;\n};\n","import memoizerific from 'memoizerific';\nimport produce from 'immer-peasy';\nimport {\n  actionNameSymbol,\n  actionStateSymbol,\n  actionSymbol,\n  computedSymbol,\n  computedConfigSymbol,\n  listenSymbol,\n  metaSymbol,\n  reducerSymbol,\n  selectDependenciesSymbol,\n  selectImpSymbol,\n  selectorConfigSymbol,\n  selectorStateSymbol,\n  selectorSymbol,\n  selectStateSymbol,\n  selectSymbol,\n  thunkStateSymbol,\n  thunkSymbol,\n} from './constants';\nimport { isStateObject, get, set } from './lib';\nimport * as helpers from './helpers';\n\nconst maxSelectFnMemoize = 100;\nconst tick = () => new Promise(resolve => setTimeout(resolve));\n\nconst errorToPayload = err => {\n  if (err instanceof Error) {\n    return {\n      message: err.message,\n      stack: err.stack,\n    };\n  }\n  if (typeof err === 'string') {\n    return err;\n  }\n  return undefined;\n};\n\nexport default function createStoreInternals({\n  disableInternalSelectFnMemoize,\n  initialState,\n  injections,\n  model,\n  reducerEnhancer,\n  references,\n}) {\n  let isInReducer = false;\n\n  const wrapFnWithMemoize = x =>\n    !disableInternalSelectFnMemoize && typeof x === 'function'\n      ? memoizerific(maxSelectFnMemoize)(x)\n      : x;\n\n  const defaultState = initialState || {};\n  let selectorId = 0;\n\n  const computedProperties = {};\n\n  const actionCreatorDict = {};\n  const actionCreators = {};\n\n  const actionListenersDict = {};\n\n  const actionReducersDict = {};\n  const actionReducersForPath = {};\n\n  const actionThunks = {};\n\n  const customReducers = [];\n\n  const listenDefinitions = [];\n\n  const listenerActionDefinitions = [];\n  const listenerActionMap = {};\n  const listenerThunkMap = {};\n\n  const selectorsDict = {};\n  const selectorReducers = [];\n\n  const thunkListenersDict = {};\n\n  const recursiveExtractDefsFromModel = (current, parentPath) =>\n    Object.keys(current).forEach(key => {\n      const value = current[key];\n      const path = [...parentPath, key];\n      const meta = {\n        parent: parentPath,\n        path,\n      };\n      if (typeof value === 'function') {\n        if (value[actionSymbol]) {\n          const name = `@action.${path.join('.')}`;\n          value[actionNameSymbol] = name;\n          value[metaSymbol] = meta;\n\n          // Action Reducer\n          const actionReducer = value;\n          actionReducer[actionNameSymbol] = name;\n          actionReducersDict[name] = actionReducer;\n          actionReducersForPath[parentPath] = actionReducer;\n\n          // Action Creator\n          const actionCreator = payload => {\n            const result = references.dispatch({\n              type: actionReducer[actionNameSymbol],\n              payload,\n            });\n            return result;\n          };\n          actionCreator[actionNameSymbol] = name;\n          actionCreatorDict[name] = actionCreator;\n          set(path, actionCreators, actionCreator);\n\n          const { config } = value[actionStateSymbol];\n          if (config && config.listenTo) {\n            listenerActionDefinitions.push(value);\n          }\n        } else if (value[thunkSymbol]) {\n          const name = `@thunk.${path.join('.')}`;\n          value[actionNameSymbol] = name;\n\n          // Thunk Action\n          const action = payload => {\n            return value(get(parentPath, actionCreators), payload, {\n              // @deprecated\n              dispatch: references.dispatch,\n              getState: () => get(parentPath, references.getState()),\n              getStoreActions: () => actionCreators,\n              getStoreState: references.getState,\n              injections,\n              meta,\n            });\n          };\n          set(path, actionThunks, action);\n\n          // Thunk Action Creator\n          const actionCreator = payload =>\n            tick()\n              .then(() =>\n                references.dispatch({\n                  type: `${name}(started)`,\n                  payload,\n                }),\n              )\n              .then(() => references.dispatch(() => action(payload)))\n              .then(result => {\n                references.dispatch({\n                  type: `${name}(completed)`,\n                  payload,\n                });\n                return result;\n              })\n              .catch(err => {\n                references.dispatch({\n                  type: `${name}(failed)`,\n                  payload,\n                  error: errorToPayload(err),\n                });\n                throw err;\n              });\n\n          actionCreator[actionNameSymbol] = name;\n          actionCreatorDict[name] = actionCreator;\n          set(path, actionCreators, actionCreator);\n\n          const { config } = value[thunkStateSymbol];\n          if (config && config.listenTo) {\n            listenerActionDefinitions.push(value);\n          }\n        } else if (value[computedSymbol]) {\n          let target = get(parentPath, defaultState);\n          if (!target) {\n            target = {};\n            set(parentPath, defaultState, target);\n          }\n          const config = value[computedConfigSymbol];\n          const { stateResolvers } = config;\n          const memoisedResultFn = memoizerific(1)(value);\n          let cache;\n          const createComputedProperty = o => {\n            Object.defineProperty(o, key, {\n              configurable: true,\n              get: () => {\n                const storeState = isInReducer\n                  ? references.currentState\n                  : references.getState();\n                const state = get(parentPath, storeState);\n                const inputs = stateResolvers.map(resolver =>\n                  resolver(state, storeState),\n                );\n                cache = memoisedResultFn(...inputs);\n                return cache;\n              },\n              set: () => {\n                throw new Error(\n                  `Easy Peasy: You attempted to set \"${path.join(\n                    '.',\n                  )}\", which is a computed property set a computed property`,\n                );\n              },\n            });\n          };\n          createComputedProperty(target);\n          set(path, computedProperties, createComputedProperty);\n        } else if (value[selectorSymbol]) {\n          selectorId += 1;\n          const selectorInstanceId = selectorId;\n          const { args, config } = value[selectorConfigSymbol];\n          const stateSelectors =\n            args && Array.isArray(args)\n              ? args.map(s => memoizerific(1)(s))\n              : [state => state];\n          const limit =\n            typeof config === 'object' &&\n            typeof config.limit === 'number' &&\n            config.limit > 0\n              ? config.number\n              : 1;\n          const internalSelector = memoizerific(limit)((...a) =>\n            value(\n              a.slice(0, stateSelectors.length),\n              a.slice(stateSelectors.length),\n            ),\n          );\n          let changeIdx = 0;\n\n          /**\n           * This allows us to track whether the state we are depending on\n           * (resolved via the state selectors), has changed. If so then we know\n           * that we should create a new instance of our selector function so\n           * that updates are propagated and memoization caches are cleared.\n           */\n          const createDependentStateChangeTracker = () => {\n            const internalChecker = memoizerific(1)(() => {\n              changeIdx += 1;\n              return changeIdx;\n            });\n            const dependentStateChangeTracker = storeState => {\n              const localState = get(parentPath, storeState);\n              const resolvedStateArgs = stateSelectors.reduce(\n                (acc, argSelector) => {\n                  acc.push(argSelector(localState, storeState));\n                  return acc;\n                },\n                [],\n              );\n              return internalChecker(...resolvedStateArgs);\n            };\n            return dependentStateChangeTracker;\n          };\n\n          /**\n           * We create a function allowing us to create new selector instances.\n           * We will need this ability to reinitialise a selector of the state\n           * it depends on changes.\n           */\n          const createSelector = () => {\n            const selector = (...runtimeArgs) => {\n              const storeState = references.getState();\n              const localState = get(parentPath, storeState);\n              const selectedStateArgs = stateSelectors.reduce(\n                (acc, argSelector) => [\n                  ...acc,\n                  argSelector(localState, storeState),\n                ],\n                [],\n              );\n              return internalSelector(...selectedStateArgs.concat(runtimeArgs));\n            };\n            selector[selectorStateSymbol] = {\n              dependentStateChangeTracker: createDependentStateChangeTracker(),\n              createSelector,\n              meta,\n              selectorId: selectorInstanceId,\n            };\n            return selector;\n          };\n          const selector = createSelector();\n          selectorsDict[selectorId] = selector;\n          set(path, defaultState, selector);\n        } else if (value[selectSymbol]) {\n          value[selectStateSymbol] = { parentPath, key, executed: false };\n          selectorReducers.push(value);\n        } else if (value[reducerSymbol]) {\n          customReducers.push({ path, reducer: value });\n        } else if (value[listenSymbol]) {\n          listenDefinitions.push(value);\n          value[metaSymbol] = meta;\n        } else if (process.env.NODE_ENV !== 'production') {\n          // eslint-disable-next-line no-console\n          console.warn(\n            `easy-peasy: Found a function at path ${path.join(\n              '.',\n            )} in your model. Version 2 required that you wrap your action functions with the \"action\" helper`,\n          );\n        }\n      } else if (isStateObject(value) && Object.keys(value).length > 0) {\n        const existing = get(path, defaultState);\n        if (existing == null) {\n          set(path, defaultState, {});\n        }\n        recursiveExtractDefsFromModel(value, path);\n      } else {\n        // State\n        const initialParentRef = get(parentPath, initialState);\n        if (initialParentRef && key in initialParentRef) {\n          set(path, defaultState, initialParentRef[key]);\n        } else {\n          set(path, defaultState, value);\n        }\n      }\n    });\n\n  recursiveExtractDefsFromModel(model, []);\n\n  listenerActionDefinitions.forEach(listenerAction => {\n    const {\n      config: { listenTo },\n    } = listenerAction[actionStateSymbol] || listenerAction[thunkStateSymbol];\n    let targetName;\n\n    const processListenTo = target => {\n      if (\n        typeof target === 'function' &&\n        target[actionNameSymbol] &&\n        actionCreatorDict[target[actionNameSymbol]]\n      ) {\n        if (target[thunkSymbol]) {\n          targetName = helpers.thunkCompleteName(target);\n        } else {\n          targetName = target[actionNameSymbol];\n        }\n      } else if (typeof target === 'string') {\n        targetName = target;\n      }\n      const listenerReg = listenerActionMap[targetName] || [];\n      listenerReg.push(actionCreatorDict[listenerAction[actionNameSymbol]]);\n      listenerActionMap[targetName] = listenerReg;\n    };\n\n    if (Array.isArray(listenTo)) {\n      listenTo.forEach(processListenTo);\n    } else {\n      processListenTo(listenTo);\n    }\n  });\n\n  selectorReducers.forEach(selector => {\n    selector[selectImpSymbol] = state => wrapFnWithMemoize(selector(state));\n  });\n\n  listenDefinitions.forEach(def => {\n    def.listeners = def.listeners || {};\n\n    const on = (target, handler) => {\n      if (typeof handler !== 'function') {\n        return;\n      }\n\n      const meta = def[metaSymbol];\n      handler[metaSymbol] = meta;\n\n      if (!handler[actionSymbol] && !handler[thunkSymbol]) {\n        if (process.env.NODE_ENV !== 'production') {\n          // eslint-disable-next-line\n          console.warn(\n            `easy-peasy: you must provide either an \"action\" or \"thunk\" to your listeners. Found an invalid handler at \"${meta.path.join(\n              '.',\n            )}\"`,\n          );\n        }\n        return;\n      }\n\n      let targetActionName;\n\n      if (\n        typeof target === 'function' &&\n        target[actionNameSymbol] &&\n        actionCreatorDict[target[actionNameSymbol]]\n      ) {\n        if (target[thunkSymbol]) {\n          targetActionName = helpers.thunkCompleteName(target);\n        } else {\n          targetActionName = target[actionNameSymbol];\n        }\n      } else if (typeof target === 'string') {\n        targetActionName = target;\n      }\n\n      if (targetActionName) {\n        if (handler[thunkSymbol]) {\n          thunkListenersDict[targetActionName] =\n            thunkListenersDict[targetActionName] || [];\n          thunkListenersDict[targetActionName].push(handler);\n        } else {\n          actionListenersDict[targetActionName] =\n            actionListenersDict[targetActionName] || [];\n          actionListenersDict[targetActionName].push({\n            path: meta.parent,\n            handler,\n          });\n        }\n        def.listeners[targetActionName] = def.listeners[targetActionName] || [];\n        def.listeners[targetActionName].push(handler);\n      }\n    };\n    def(on);\n  });\n\n  const runSelectorReducer = (state, selector) => {\n    const { parentPath, key, executed } = selector[selectStateSymbol];\n    if (executed) {\n      return state;\n    }\n    const dependencies = selector[selectDependenciesSymbol];\n\n    const stateAfterDependencies = dependencies\n      ? dependencies.reduce(runSelectorReducer, state)\n      : state;\n\n    let newState = stateAfterDependencies;\n\n    if (parentPath.length > 0) {\n      const target = get(parentPath, stateAfterDependencies);\n      if (target) {\n        if (\n          !selector.prevState ||\n          selector.prevState !== get(parentPath, state)\n        ) {\n          const newValue = selector[selectImpSymbol](target);\n          newState = produce(state, draft => {\n            const updateTarget = get(parentPath, draft);\n            updateTarget[key] = newValue;\n          });\n          selector.prevState = get(parentPath, newState);\n        }\n      }\n    } else if (!selector.prevState || selector.prevState !== state) {\n      const newValue = selector[selectImpSymbol](stateAfterDependencies);\n      newState = produce(state, draft => {\n        draft[key] = newValue;\n      });\n      selector.prevState = newState;\n    }\n\n    selector[selectStateSymbol].executed = true;\n    return newState;\n  };\n\n  const runSelectors = state =>\n    selectorReducers.reduce(runSelectorReducer, state);\n\n  const createReducer = () => {\n    const runActionReducerAtPath = (state, action, actionReducer, path) => {\n      const current = get(path, state);\n      const updatedState =\n        path.length === 0\n          ? produce(state, _draft => actionReducer(_draft, action.payload))\n          : produce(state, draft => {\n              set(\n                actionReducer[metaSymbol].parent,\n                draft,\n                produce(current, _draft =>\n                  actionReducer(_draft, action.payload),\n                ),\n              );\n            });\n\n      if (updatedState !== state) {\n        const computedPropertyCreators = get(path, computedProperties);\n        if (computedPropertyCreators) {\n          const updatedCurrent = get(path, updatedState);\n          Object.keys(computedPropertyCreators).forEach(key => {\n            computedPropertyCreators[key](updatedCurrent);\n          });\n        }\n      }\n\n      return updatedState;\n    };\n\n    const reducerForActions = (state, action) => {\n      const actionReducer = actionReducersDict[action.type];\n      if (actionReducer) {\n        return runActionReducerAtPath(\n          state,\n          action,\n          actionReducer,\n          actionReducer[metaSymbol].parent,\n        );\n      }\n      return state;\n    };\n\n    const reducerForListeners = (state, action) => {\n      const target =\n        action.type === '@@EP/LISTENER' ? action.actionName : action.type;\n      const actionListeners = actionListenersDict[target];\n      if (actionListeners) {\n        const targetAction =\n          action.type === '@@EP/LISTENER'\n            ? { type: target, payload: action.payload }\n            : action;\n        return actionListeners.reduce(\n          (newState, { path, handler }) =>\n            runActionReducerAtPath(newState, targetAction, handler, path),\n          state,\n        );\n      }\n      return state;\n    };\n\n    const reducerForCustomReducers = (state, action) => {\n      return produce(state, draft => {\n        customReducers.forEach(({ path: p, reducer: red }) => {\n          const current = get(p, draft);\n          set(p, draft, red(current, action));\n        });\n      });\n    };\n\n    let isInitial = true;\n\n    const selectsReducer = state => {\n      const stateAfterSelectors = runSelectors(state);\n      isInitial = false;\n      selectorReducers.forEach(selector => {\n        selector[selectStateSymbol].executed = false;\n      });\n      return stateAfterSelectors;\n    };\n\n    const selectorsReducer = state => {\n      const selectors = Object.values(selectorsDict);\n      return produce(state, draft => {\n        selectors.forEach(selector => {\n          const selectorState = selector[selectorStateSymbol];\n          if (selectorState.prevStateCheckId == null) {\n            selectorState.prevStateCheckId = selectorState.dependentStateChangeTracker(\n              state,\n            );\n          } else {\n            const nextStateCheckId = selectorState.dependentStateChangeTracker(\n              state,\n            );\n            if (selectorState.prevStateCheckId !== nextStateCheckId) {\n              const newSelector = selectorState.createSelector();\n              newSelector[selectorState.prevStateCheckId] = nextStateCheckId;\n              selectorsDict[selectorState.selectorId] = newSelector;\n              set(selectorState.meta.path, draft, newSelector);\n            }\n          }\n        });\n      });\n    };\n\n    const rootReducer = (state, action) => {\n      isInReducer = true;\n      const stateAfterActions = reducerForActions(state, action);\n      const stateAfterListeners = reducerForListeners(\n        stateAfterActions,\n        action,\n      );\n      const stateAfterCustomReducers = reducerForCustomReducers(\n        stateAfterListeners,\n        action,\n      );\n      const stateAfterSelect =\n        state !== stateAfterCustomReducers || isInitial\n          ? selectsReducer(stateAfterCustomReducers)\n          : stateAfterCustomReducers;\n      const result = selectorsReducer(stateAfterSelect);\n      isInReducer = false;\n      return result;\n    };\n\n    return rootReducer;\n  };\n\n  return {\n    actionCreators,\n    actionListenersDict,\n    defaultState,\n    listenDefinitions,\n    listenerActionMap,\n    listenerThunkMap,\n    reducer: reducerEnhancer(createReducer()),\n    thunkListenersDict,\n  };\n}\n","import {\n  applyMiddleware,\n  compose as reduxCompose,\n  createStore as reduxCreateStore,\n} from 'redux';\nimport reduxThunk from 'redux-thunk';\nimport { get } from './lib';\nimport { metaSymbol, actionSymbol, thunkSymbol } from './constants';\nimport * as helpers from './helpers';\nimport createStoreInternals from './create-store-internals';\nimport { useStoreActions, useStoreDispatch, useStoreState } from './hooks';\n\nexport default function createStore(model, options = {}) {\n  const {\n    compose,\n    devTools = true,\n    disableInternalSelectFnMemoize = false,\n    enhancers = [],\n    initialState = {},\n    injections,\n    middleware = [],\n    mockActions = false,\n    name: storeName = `EasyPeasyStore`,\n    reducerEnhancer = rootReducer => rootReducer,\n  } = options;\n\n  const modelDefinition = {\n    ...model,\n    logFullState: helpers.thunk((actions, payload, { getState }) => {\n      // eslint-disable-next-line no-console\n      console.log(JSON.stringify(getState(), null, 2));\n    }),\n    replaceState: helpers.action((state, payload) => payload),\n  };\n\n  const references = {};\n\n  let mockedActions = [];\n\n  const dispatchThunk = (thunk, payload) =>\n    thunk(\n      get(thunk[metaSymbol].parent, references.internals.actionCreators),\n      payload,\n      {\n        dispatch: references.dispatch,\n        getState: () => get(thunk[metaSymbol].parent, references.getState()),\n        getStoreState: references.getState,\n        injections,\n        meta: thunk[metaSymbol],\n      },\n    );\n\n  const dispatchThunkListeners = (name, payload) => {\n    const listensForAction = references.internals.thunkListenersDict[name];\n    return listensForAction && listensForAction.length > 0\n      ? Promise.all(\n          listensForAction.map(listenForAction =>\n            dispatchThunk(listenForAction, payload),\n          ),\n        )\n      : Promise.resolve();\n  };\n\n  const dispatchActionStringListeners = () => next => action => {\n    const result = next(action);\n    if (references.internals.thunkListenersDict[action.type]) {\n      dispatchThunkListeners(action.type, action.payload);\n    }\n    return result;\n  };\n\n  const composeEnhancers =\n    compose ||\n    (devTools &&\n    typeof window !== 'undefined' &&\n    window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n      ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({\n          name: storeName,\n        })\n      : reduxCompose);\n\n  const bindStoreInternals = state => {\n    references.internals = createStoreInternals({\n      disableInternalSelectFnMemoize,\n      initialState: state,\n      injections,\n      model: modelDefinition,\n      reducerEnhancer,\n      references,\n    });\n  };\n\n  bindStoreInternals(initialState);\n\n  const listenerActionsMiddleware = () => next => action => {\n    const result = next(action);\n    if (\n      action &&\n      references.internals.listenerActionMap[action.type] &&\n      references.internals.listenerActionMap[action.type].length > 0\n    ) {\n      references.internals.listenerActionMap[action.type].forEach(\n        actionCreator => {\n          actionCreator(action.payload);\n        },\n      );\n    }\n    return result;\n  };\n\n  const mockActionsMiddleware = () => next => action => {\n    if (mockActions) {\n      if (\n        action == null ||\n        (typeof action === 'object' && action.type === '@@EP/LISTENER')\n      ) {\n        // DO NOTHING\n      } else {\n        mockedActions.push(action);\n      }\n      return undefined;\n    }\n    return next(action);\n  };\n\n  const currentStateMiddleware = () => next => action => {\n    references.currentState = references.getState();\n    return next(action);\n  };\n\n  const store = reduxCreateStore(\n    references.internals.reducer,\n    references.internals.defaultState,\n    composeEnhancers(\n      applyMiddleware(\n        reduxThunk,\n        dispatchActionStringListeners,\n        ...middleware,\n        listenerActionsMiddleware,\n        currentStateMiddleware,\n        mockActionsMiddleware,\n      ),\n      ...enhancers,\n    ),\n  );\n\n  store.getMockedActions = () => [...mockedActions];\n  store.clearMockedActions = () => {\n    mockedActions = [];\n  };\n\n  references.dispatch = store.dispatch;\n  references.getState = store.getState;\n\n  // attach the action creators to dispatch\n  const bindActionCreators = actionCreators => {\n    Object.keys(store.dispatch).forEach(actionsKey => {\n      delete store.dispatch[actionsKey];\n    });\n    Object.keys(actionCreators).forEach(key => {\n      store.dispatch[key] = actionCreators[key];\n    });\n    store.getActions = () => actionCreators;\n  };\n\n  bindActionCreators(references.internals.actionCreators);\n\n  const rebindStore = removeKey => {\n    const currentState = store.getState();\n    if (removeKey) {\n      delete currentState[removeKey];\n    }\n    bindStoreInternals(store.getState());\n    store.replaceReducer(references.internals.reducer);\n    store.dispatch.replaceState(references.internals.defaultState);\n    bindActionCreators(references.internals.actionCreators);\n  };\n\n  store.addModel = (key, modelForKey) => {\n    if (modelDefinition[key] && process.env.NODE_ENV !== 'production') {\n      // eslint-disable-next-line no-console\n      console.warn(\n        `easy-peasy: The store model already contains a model definition for \"${key}\"`,\n      );\n      store.removeModel(key);\n    }\n    modelDefinition[key] = modelForKey;\n    rebindStore();\n  };\n\n  store.removeModel = key => {\n    if (!modelDefinition[key]) {\n      if (process.env.NODE_ENV !== 'production') {\n        // eslint-disable-next-line no-console\n        console.warn(\n          `easy-peasy: The store model does not contain a model definition for \"${key}\"`,\n        );\n      }\n      return;\n    }\n    delete modelDefinition[key];\n    rebindStore(key);\n  };\n\n  // @deprecated\n  const dispatchActionListener = (actionName, payload) =>\n    store.dispatch({\n      type: '@@EP/LISTENER',\n      payload,\n      actionName,\n    });\n\n  const resolveActionName = action =>\n    typeof action === 'function'\n      ? action[actionSymbol]\n        ? helpers.actionName(action)\n        : action[thunkSymbol]\n        ? helpers.thunkCompleteName(action)\n        : undefined\n      : typeof action === 'string'\n      ? action\n      : undefined;\n\n  // @deprecated\n  store.triggerListener = (listener, action, payload) => {\n    const actionName = resolveActionName(action);\n    if (\n      listener.listeners[actionName] &&\n      listener.listeners[actionName].length > 0\n    ) {\n      if (\n        listener.listeners[actionName].some(handler => handler[actionSymbol])\n      ) {\n        dispatchActionListener(actionName, payload);\n      }\n      const thunkHandlers = listener.listeners[actionName].filter(\n        handler => handler[thunkSymbol],\n      );\n      return thunkHandlers.length > 0\n        ? Promise.all(\n            thunkHandlers.map(handler => dispatchThunk(handler, payload)),\n          ).then(() => undefined)\n        : Promise.resolve();\n    }\n    return Promise.resolve();\n  };\n\n  // @deprecated\n  store.triggerListeners = (action, payload) => {\n    const actionName = resolveActionName(action);\n    if (actionName) {\n      const actionListenerHandlers =\n        references.internals.actionListenersDict[actionName];\n      if (actionListenerHandlers && actionListenerHandlers.length > 0) {\n        dispatchActionListener(actionName, payload);\n      }\n      const thunkListenerHandlers =\n        references.internals.thunkListenersDict[actionName];\n      return thunkListenerHandlers && thunkListenerHandlers.length > 0\n        ? Promise.all(\n            thunkListenerHandlers.map(handler =>\n              dispatchThunk(handler, payload),\n            ),\n          ).then(() => undefined)\n        : Promise.resolve();\n    }\n    return Promise.resolve();\n  };\n\n  store.useStoreActions = useStoreActions;\n  store.useStoreDispatch = useStoreDispatch;\n  store.useStoreState = useStoreState;\n\n  return store;\n}\n","/* eslint-disable react/prop-types */\n\nimport React, { createContext, useContext, useMemo } from 'react';\nimport {\n  createStoreActionsHook,\n  createStoreDispatchHook,\n  createStoreStateHook,\n} from './hooks';\nimport createStore from './create-store';\n\nexport default function createContextStore(model, config) {\n  const StoreContext = createContext();\n\n  function Provider({ children, initialData }) {\n    const store = useMemo(\n      () =>\n        createStore(\n          typeof model === 'function' ? model(initialData) : model,\n          config,\n        ),\n      [],\n    );\n    return (\n      <StoreContext.Provider value={store}>{children}</StoreContext.Provider>\n    );\n  }\n\n  function useStore() {\n    return useContext(StoreContext);\n  }\n\n  return {\n    Provider,\n    useStore,\n    useStoreState: createStoreStateHook(StoreContext),\n    useStoreActions: createStoreActionsHook(StoreContext),\n    useStoreDispatch: createStoreDispatchHook(StoreContext),\n  };\n}\n","import { useMemo, useState, useRef, useEffect } from 'react';\nimport createStore from './create-store';\n\n/**\n * Some good references on the topic of reinitialisation:\n * - https://github.com/facebook/react/issues/14830\n */\n\nexport default function createComponentStore(model, config) {\n  return function useLocalStore(initialData) {\n    const store = useMemo(\n      () =>\n        createStore(\n          typeof model === 'function' ? model(initialData) : model,\n          config,\n        ),\n      [],\n    );\n    const previousStateRef = useRef(store.getState());\n    const [currentState, setCurrentState] = useState(() => store.getState());\n    useEffect(() => {\n      return store.subscribe(() => {\n        const nextState = store.getState();\n        if (previousStateRef.current !== nextState) {\n          previousStateRef.current = nextState;\n          setCurrentState(nextState);\n        }\n      });\n    }, [store]);\n    return [currentState, store.dispatch];\n  };\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport StoreContext from './context';\n\nconst StoreProvider = ({ children, store }) => (\n  <StoreContext.Provider value={store}>{children}</StoreContext.Provider>\n);\n\nStoreProvider.propTypes = {\n  children: PropTypes.node.isRequired,\n  store: PropTypes.object.isRequired,\n};\n\nexport default StoreProvider;\n","import { setAutoFreeze } from 'immer-peasy';\nimport {\n  createTypedHooks,\n  useActions,\n  useDispatch,\n  useStore,\n  useStoreActions,\n  useStoreDispatch,\n  useStoreState,\n} from './hooks';\nimport createStore from './create-store';\nimport createContextStore from './create-context-store';\nimport createComponentStore from './create-component-store';\nimport StoreProvider from './provider';\nimport {\n  action,\n  actionName,\n  computed,\n  debug,\n  listen,\n  memo,\n  reducer,\n  select,\n  selector,\n  thunk,\n  thunkCompleteName,\n  thunkFailName,\n  thunkStartName,\n} from './helpers';\n\n/**\n * immer is an implementation detail, so we are not going to use its auto freeze\n * behaviour, which throws errors if trying to mutate state. It's also risky\n * for production builds as has a perf overhead.\n *\n * @see https://github.com/mweststrate/immer#auto-freezing\n */\nsetAutoFreeze(false);\n\nexport {\n  action,\n  actionName,\n  computed,\n  createContextStore,\n  createComponentStore,\n  createStore,\n  createTypedHooks,\n  debug,\n  listen,\n  memo,\n  reducer,\n  select,\n  selector,\n  StoreProvider,\n  thunk,\n  thunkCompleteName,\n  thunkFailName,\n  thunkStartName,\n  useActions,\n  useDispatch,\n  useStore,\n  useStoreActions,\n  useStoreDispatch,\n  useStoreState,\n};\n"],"names":["StoreContext","createContext","isStateObject","x","Array","isArray","get","path","target","reduce","acc","cur","undefined","set","value","idx","length","createStoreStateHook","Context","useStoreState","mapState","dependencies","store","useContext","useState","getState","state","setState","error","setError","stateRef","useRef","isActive","unmounted","useEffect","current","calculateState","newState","shallowEqual","err","setTimeout","unsubscribe","subscribe","EasyPeasyContext","createStoreActionsHook","useStoreActions","mapActions","dispatch","createStoreDispatchHook","useStoreDispatch","wrapWithWarning","prev","next","useImp","warned","useDeprecated","console","warn","useActions","useDispatch","useStore","createTypedHooks","actionNameSymbol","actionSymbol","actionStateSymbol","computedSymbol","computedConfigSymbol","listenSymbol","metaSymbol","reducerSymbol","selectDependenciesSymbol","selectImpSymbol","selectStateSymbol","selectSymbol","selectorSymbol","selectorConfigSymbol","selectorStateSymbol","thunkSymbol","thunkStateSymbol","actionName","action","debug","isDraft","final","finishDraft","createDraft","thunkStartName","thunkCompleteName","thunkFailName","fn","config","defaultStateResolvers","computed","stateResolvers","listen","memo","cacheSize","memoizerific","thunk","select","selector","args","reducer","maxSelectFnMemoize","tick","Promise","resolve","errorToPayload","Error","message","stack","createStoreInternals","disableInternalSelectFnMemoize","initialState","injections","model","reducerEnhancer","references","isInReducer","wrapFnWithMemoize","defaultState","selectorId","computedProperties","actionCreatorDict","actionCreators","actionListenersDict","actionReducersDict","actionThunks","customReducers","listenDefinitions","listenerActionDefinitions","listenerActionMap","listenerThunkMap","selectorsDict","selectorReducers","thunkListenersDict","recursiveExtractDefsFromModel","parentPath","Object","keys","forEach","key","meta","parent","name","join","actionReducer","actionReducersForPath","actionCreator","payload","result","type","listenTo","push","getStoreActions","getStoreState","then","catch","memoisedResultFn","cache","createComputedProperty","o","defineProperty","configurable","storeState","currentState","inputs","map","resolver","selectorInstanceId","stateSelectors","s","limit","number","internalSelector","a","slice","changeIdx","createDependentStateChangeTracker","internalChecker","dependentStateChangeTracker","localState","resolvedStateArgs","argSelector","createSelector","selectedStateArgs","runtimeArgs","concat","executed","existing","initialParentRef","listenerAction","targetName","processListenTo","helpers","listenerReg","def","listeners","on","handler","targetActionName","runSelectorReducer","stateAfterDependencies","prevState","newValue","produce","draft","updateTarget","runSelectors","createReducer","runActionReducerAtPath","updatedState","_draft","computedPropertyCreators","updatedCurrent","reducerForActions","reducerForListeners","actionListeners","targetAction","reducerForCustomReducers","p","red","isInitial","selectsReducer","stateAfterSelectors","selectorsReducer","selectors","values","selectorState","prevStateCheckId","nextStateCheckId","newSelector","rootReducer","stateAfterActions","stateAfterListeners","stateAfterCustomReducers","stateAfterSelect","createStore","options","compose","devTools","enhancers","middleware","mockActions","storeName","modelDefinition","logFullState","actions","log","JSON","stringify","replaceState","mockedActions","dispatchThunk","internals","dispatchThunkListeners","listensForAction","all","listenForAction","dispatchActionStringListeners","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","reduxCompose","bindStoreInternals","listenerActionsMiddleware","mockActionsMiddleware","currentStateMiddleware","reduxCreateStore","applyMiddleware","reduxThunk","getMockedActions","clearMockedActions","bindActionCreators","actionsKey","getActions","rebindStore","removeKey","replaceReducer","addModel","modelForKey","removeModel","dispatchActionListener","resolveActionName","triggerListener","listener","some","thunkHandlers","filter","triggerListeners","actionListenerHandlers","thunkListenerHandlers","createContextStore","Provider","children","initialData","useMemo","React","createComponentStore","useLocalStore","previousStateRef","setCurrentState","nextState","StoreProvider","setAutoFreeze"],"mappings":";;;;;;;;;;;EAAA;;EAEA,gBAAc,GAAG,SAAS,YAAY,CAAC,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,cAAc,EAAE;IAC1E,IAAI,GAAG,GAAG,OAAO,GAAG,OAAO,CAAC,IAAI,CAAC,cAAc,EAAE,IAAI,EAAE,IAAI,CAAC,GAAG,KAAK,CAAC,CAAC;;IAEtE,IAAI,GAAG,KAAK,KAAK,CAAC,EAAE;MAClB,OAAO,CAAC,CAAC,GAAG,CAAC;KACd;;IAED,IAAI,IAAI,KAAK,IAAI,EAAE;MACjB,OAAO,IAAI,CAAC;KACb;;IAED,IAAI,OAAO,IAAI,KAAK,QAAQ,IAAI,CAAC,IAAI,IAAI,OAAO,IAAI,KAAK,QAAQ,IAAI,CAAC,IAAI,EAAE;MAC1E,OAAO,KAAK,CAAC;KACd;;IAED,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC9B,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;;IAE9B,IAAI,KAAK,CAAC,MAAM,KAAK,KAAK,CAAC,MAAM,EAAE;MACjC,OAAO,KAAK,CAAC;KACd;;IAED,IAAI,eAAe,GAAG,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;;;IAGjE,KAAK,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,GAAG,KAAK,CAAC,MAAM,EAAE,GAAG,EAAE,EAAE;MAC3C,IAAI,GAAG,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC;;MAErB,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE;QACzB,OAAO,KAAK,CAAC;OACd;;MAED,IAAI,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;MACvB,IAAI,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;;MAEvB,GAAG,GAAG,OAAO,GAAG,OAAO,CAAC,IAAI,CAAC,cAAc,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,CAAC,GAAG,KAAK,CAAC,CAAC;;MAE3E,IAAI,GAAG,KAAK,KAAK,KAAK,GAAG,KAAK,KAAK,CAAC,IAAI,MAAM,KAAK,MAAM,CAAC,EAAE;QAC1D,OAAO,KAAK,CAAC;OACd;KACF;;IAED,OAAO,IAAI,CAAC;GACb,CAAC;;EC3CF,IAAMA,YAAY,GAAGC,mBAAa,EAAlC;;ECFO,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAAAC,CAAC;EAAA,SAC5BA,CAAC,KAAK,IAAN,IAAc,OAAOA,CAAP,KAAa,QAA3B,IAAuC,CAACC,KAAK,CAACC,OAAN,CAAcF,CAAd,CADZ;EAAA,CAAvB;AAGP,EAAO,IAAMG,GAAG,GAAG,SAANA,GAAM,CAACC,IAAD,EAAOC,MAAP;EAAA,SACjBD,IAAI,CAACE,MAAL,CACE,UAACC,GAAD,EAAMC,GAAN;EAAA,WAAeT,aAAa,CAACQ,GAAD,CAAb,GAAqBA,GAAG,CAACC,GAAD,CAAxB,GAAgCC,SAA/C;EAAA,GADF,EAEEJ,MAFF,CADiB;EAAA,CAAZ;AAMP,EAAO,IAAMK,GAAG,GAAG,SAANA,GAAM,CAACN,IAAD,EAAOC,MAAP,EAAeM,KAAf,EAAyB;EAC1CP,EAAAA,IAAI,CAACE,MAAL,CAAY,UAACC,GAAD,EAAMC,GAAN,EAAWI,GAAX,EAAmB;EAC7B,QAAIA,GAAG,GAAG,CAAN,KAAYR,IAAI,CAACS,MAArB,EAA6B;EAC3BN,MAAAA,GAAG,CAACC,GAAD,CAAH,GAAWG,KAAX;EACD,KAFD,MAEO;EACLJ,MAAAA,GAAG,CAACC,GAAD,CAAH,GAAWD,GAAG,CAACC,GAAD,CAAH,IAAY,EAAvB;EACD;;EACD,WAAOD,GAAG,CAACC,GAAD,CAAV;EACD,GAPD,EAOGH,MAPH;EAQD,CATM;;ECJA,SAASS,oBAAT,CAA8BC,OAA9B,EAAuC;EAC5C,SAAO,SAASC,aAAT,CAAuBC,QAAvB,EAAiCC,YAAjC,EAAoD;EAAA,QAAnBA,YAAmB;EAAnBA,MAAAA,YAAmB,GAAJ,EAAI;EAAA;;EACzD,QAAMC,KAAK,GAAGC,gBAAU,CAACL,OAAD,CAAxB;;EADyD,oBAE/BM,cAAQ,CAAC;EAAA,aAAMJ,QAAQ,CAACE,KAAK,CAACG,QAAN,EAAD,CAAd;EAAA,KAAD,CAFuB;EAAA,QAElDC,KAFkD;EAAA,QAE3CC,QAF2C;;EAAA,qBAG/BH,cAAQ,CAAC,IAAD,CAHuB;EAAA,QAGlDI,KAHkD;EAAA,QAG3CC,QAH2C;EAKzD;;;EACA,QAAMC,QAAQ,GAAGC,YAAM,CAACL,KAAD,CAAvB,CANyD;;EAQzD,QAAMM,QAAQ,GAAGD,YAAM,CAAC,IAAD,CAAvB,CARyD;;EAUzD,QAAME,SAAS,GAAGF,YAAM,CAAC,KAAD,CAAxB,CAVyD;EAYzD;;EACA,QAAIH,KAAJ,EAAW;EACT,YAAMA,KAAN;EACD;;EACDM,IAAAA,eAAS,CAAC,YAAM;EACdF,MAAAA,QAAQ,CAACG,OAAT,GAAmB,IAAnB;;EACA,UAAMC,cAAc,GAAG,SAAjBA,cAAiB,GAAM;EAC3B,YAAI,CAACJ,QAAQ,CAACG,OAAd,EAAuB;EACrB;EACD;;EACD,YAAI;EACF,cAAME,QAAQ,GAAGjB,QAAQ,CAACE,KAAK,CAACG,QAAN,EAAD,CAAzB;;EACA,cACEY,QAAQ,KAAKP,QAAQ,CAACK,OAAtB,IACCjC,aAAa,CAACmC,QAAD,CAAb,IACCnC,aAAa,CAAC4B,QAAQ,CAACK,OAAV,CADd,IAECG,YAAY,CAACD,QAAD,EAAWP,QAAQ,CAACK,OAApB,CAJhB,EAKE;EACA;EACA;EACD;;EACDL,UAAAA,QAAQ,CAACK,OAAT,GAAmBE,QAAnB;EACAV,UAAAA,QAAQ,CAAC;EAAA,mBAAMG,QAAQ,CAACK,OAAf;EAAA,WAAD,CAAR;EACD,SAbD,CAaE,OAAOI,GAAP,EAAY;EACZ;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EAEA;EACA;EACAP,UAAAA,QAAQ,CAACG,OAAT,GAAmB,KAAnB;EAEAK,UAAAA,UAAU,CAAC,YAAM;EACf,gBAAI,CAACP,SAAS,CAACE,OAAX,IAAsB,CAACH,QAAQ,CAACG,OAApC,EAA6C;EAC3CN,cAAAA,QAAQ,CAACU,GAAD,CAAR;EACD;EACF,WAJS,EAIP,GAJO,CAAV,CAfY;EAoBb;EACF,OAtCD;;EAuCAH,MAAAA,cAAc;EACd,UAAMK,WAAW,GAAGnB,KAAK,CAACoB,SAAN,CAAgBN,cAAhB,CAApB;EACA,aAAO,YAAM;EACXJ,QAAAA,QAAQ,CAACG,OAAT,GAAmB,KAAnB;EACAM,QAAAA,WAAW;EACZ,OAHD;EAID,KA/CQ,EA+CNpB,YA/CM,CAAT,CAhByD;EAkEzD;;EACAa,IAAAA,eAAS,CAAC,YAAM;EACd,aAAO,YAAM;EACXD,QAAAA,SAAS,CAACE,OAAV,GAAoB,IAApB;EACD,OAFD;EAGD,KAJQ,EAIN,EAJM,CAAT;EAKA,WAAOT,KAAP;EACD,GAzED;EA0ED;AAED,MAAaP,aAAa,GAAGF,oBAAoB,CAAC0B,YAAD,CAA1C;AAEP,EAAO,SAASC,sBAAT,CAAgC1B,OAAhC,EAAyC;EAC9C,SAAO,SAAS2B,eAAT,CAAyBC,UAAzB,EAAqC;EAC1C,QAAMxB,KAAK,GAAGC,gBAAU,CAACL,OAAD,CAAxB;EACA,WAAO4B,UAAU,CAACxB,KAAK,CAACyB,QAAP,CAAjB;EACD,GAHD;EAID;AAED,MAAaF,eAAe,GAAGD,sBAAsB,CAACD,YAAD,CAA9C;AAEP,EAAO,SAASK,uBAAT,CAAiC9B,OAAjC,EAA0C;EAC/C,SAAO,SAAS+B,gBAAT,GAA4B;EACjC,QAAM3B,KAAK,GAAGC,gBAAU,CAACL,OAAD,CAAxB;EACA,WAAOI,KAAK,CAACyB,QAAb;EACD,GAHD;EAID;AAED,MAAaE,gBAAgB,GAAGD,uBAAuB,CAACL,YAAD,CAAhD;;EAEP,IAAMO,eAAe,GAAG,SAAlBA,eAAkB,CAACC,IAAD,EAAOC,IAAP,EAAaC,MAAb,EAAwB;EAC9C,MAAIC,MAAM,GAAG,KAAb;EACA,SAAO,SAASC,aAAT,GAAgC;EACrC,QAAI,AAAyC,CAACD,MAA9C,EAAsD;EACpD;EACAE,MAAAA,OAAO,CAACC,IAAR,wBACsBN,IADtB,6EACgGC,IADhG;EAGAE,MAAAA,MAAM,GAAG,IAAT;EACD;;EACD,WAAOD,MAAM,MAAN,mBAAP;EACD,GATD;EAUD,CAZD;;AAcA,MAAaK,UAAU,GAAGR,eAAe,CACvC,YADuC,EAEvC,iBAFuC,EAGvCL,eAHuC,CAAlC;AAMP,MAAac,WAAW,GAAGT,eAAe,CACxC,aADwC,EAExC,kBAFwC,EAGxCD,gBAHwC,CAAnC;AAMP,MAAaW,QAAQ,GAAGV,eAAe,CACrC,UADqC,EAErC,eAFqC,EAGrC/B,aAHqC,CAAhC;AAMP,EAAO,SAAS0C,gBAAT,GAA4B;EACjC,SAAO;EACLH,IAAAA,UAAU,EAAVA,UADK;EAELC,IAAAA,WAAW,EAAXA,WAFK;EAGLC,IAAAA,QAAQ,EAARA,QAHK;EAILf,IAAAA,eAAe,EAAfA,eAJK;EAKLI,IAAAA,gBAAgB,EAAhBA,gBALK;EAML9B,IAAAA,aAAa,EAAbA;EANK,GAAP;EAQD;;;;;;;;;;;;;;;;;;;;EC/IM,IAAM2C,gBAAgB,GAAG,gBAAzB;AACP,EAAO,IAAMC,YAAY,GAAG,YAArB;AACP,EAAO,IAAMC,iBAAiB,GAAG,iBAA1B;AAEP,EAAO,IAAMC,cAAc,GAAG,oBAAvB;AACP,EAAO,IAAMC,oBAAoB,GAAG,0BAA7B;AAEP,EAAO,IAAMC,YAAY,GAAG,YAArB;AAEP,EAAO,IAAMC,UAAU,GAAG,UAAnB;AAEP,EAAO,IAAMC,aAAa,GAAG,aAAtB;AAEP,EAAO,IAAMC,wBAAwB,GAAG,wBAAjC;AACP,EAAO,IAAMC,eAAe,GAAG,eAAxB;AACP,EAAO,IAAMC,iBAAiB,GAAG,iBAA1B;AACP,EAAO,IAAMC,YAAY,GAAG,YAArB;AAEP,EAAO,IAAMC,cAAc,GAAG,cAAvB;AACP,EAAO,IAAMC,oBAAoB,GAAG,oBAA7B;AACP,EAAO,IAAMC,mBAAmB,GAAG,mBAA5B;AAEP,EAAO,IAAMC,WAAW,GAAG,WAApB;AACP,EAAO,IAAMC,gBAAgB,GAAG,gBAAzB;;MCJMC,UAAU,GAAG,SAAbA,UAAa,CAAAC,MAAM;EAAA,SAAIA,MAAM,CAAClB,gBAAD,CAAV;EAAA,CAAzB;AAEP,MAAamB,KAAK,GAAG,SAARA,KAAQ,CAAAvD,KAAK,EAAI;EAC5B,MAAIwD,eAAO,CAACxD,KAAD,CAAX,EAAoB;EAClB,QAAMyD,KAAK,GAAGC,mBAAW,CAACC,mBAAW,CAAC3D,KAAD,CAAZ,CAAzB;EACA,WAAOyD,KAAP;EACD;;EACD,SAAOzD,KAAP;EACD,CANM;AAQP,MAAa4D,cAAc,GAAG,SAAjBA,cAAiB,CAAAN,MAAM;EAAA,SAAOA,MAAM,CAAClB,gBAAD,CAAb;EAAA,CAA7B;AAEP,MAAayB,iBAAiB,GAAG,SAApBA,iBAAoB,CAAAP,MAAM;EAAA,SAClCA,MAAM,CAAClB,gBAAD,CAD4B;EAAA,CAAhC;AAGP,MAAa0B,aAAa,GAAG,SAAhBA,aAAgB,CAAAR,MAAM;EAAA,SAAOA,MAAM,CAAClB,gBAAD,CAAb;EAAA,CAA5B;AAEP,MAAakB,MAAM,GAAG,SAATA,MAAS,CAACS,EAAD,EAAKC,MAAL,EAAgB;EACpCD,EAAAA,EAAE,CAAC1B,YAAD,CAAF,GAAmB,IAAnB;EACA0B,EAAAA,EAAE,CAACzB,iBAAD,CAAF,GAAwB;EACtB0B,IAAAA,MAAM,EAANA;EADsB,GAAxB;EAGA,SAAOD,EAAP;EACD,CANM;EAQP,IAAME,qBAAqB,GAAG,CAAC,UAAAjE,KAAK;EAAA,SAAIA,KAAJ;EAAA,CAAN,CAA9B;AAEA,MAAakE,QAAQ,GAAG,SAAXA,QAAW,CAACH,EAAD,EAAKI,cAAL,EAAgD;EAAA,MAA3CA,cAA2C;EAA3CA,IAAAA,cAA2C,GAA1BF,qBAA0B;EAAA;;EACtEF,EAAAA,EAAE,CAACxB,cAAD,CAAF,GAAqB,IAArB;EACAwB,EAAAA,EAAE,CAACvB,oBAAD,CAAF,GAA2B;EACzB2B,IAAAA,cAAc,EAAdA;EADyB,GAA3B;EAGA,SAAOJ,EAAP;EACD,CANM;AAQP,MAAaK,MAAM,GAAG,SAATA,MAAS,CAAAL,EAAE,EAAI;EAC1BA,EAAAA,EAAE,CAACtB,YAAD,CAAF,GAAmB,IAAnB;EACA,SAAOsB,EAAP;EACD,CAHM;AAKP,MAAaM,IAAI,GAAG,SAAPA,IAAO,CAACN,EAAD,EAAKO,SAAL;EAAA,SAAmBC,YAAY,CAACD,SAAD,CAAZ,CAAwBP,EAAxB,CAAnB;EAAA,CAAb;AAEP,MAAaS,KAAK,GAAG,SAARA,KAAQ,CAACT,EAAD,EAAKC,MAAL,EAAgB;EACnCD,EAAAA,EAAE,CAACZ,WAAD,CAAF,GAAkB,IAAlB;EACAY,EAAAA,EAAE,CAACX,gBAAD,CAAF,GAAuB;EACrBY,IAAAA,MAAM,EAANA;EADqB,GAAvB;EAGA,SAAOD,EAAP;EACD,CANM;AAQP,MAAaU,MAAM,GAAG,SAATA,MAAS,CAACV,EAAD,EAAKpE,YAAL,EAAsB;EAC1CoE,EAAAA,EAAE,CAAChB,YAAD,CAAF,GAAmB,IAAnB;EACAgB,EAAAA,EAAE,CAACnB,wBAAD,CAAF,GAA+BjD,YAA/B;EACAoE,EAAAA,EAAE,CAACjB,iBAAD,CAAF,GAAwB,EAAxB;EACA,SAAOiB,EAAP;EACD,CALM;AAOP,MAAaW,QAAQ,GAAG,SAAXA,QAAW,CAACC,IAAD,EAAOZ,EAAP,EAAWC,MAAX,EAAsB;EAC5CD,EAAAA,EAAE,CAACf,cAAD,CAAF,GAAqB,IAArB;EACAe,EAAAA,EAAE,CAACd,oBAAD,CAAF,GAA2B;EACzB0B,IAAAA,IAAI,EAAJA,IADyB;EAEzBX,IAAAA,MAAM,EAANA;EAFyB,GAA3B;EAIA,SAAOD,EAAP;EACD,CAPM;AASP,MAAaa,OAAO,GAAG,SAAVA,OAAU,CAAAb,EAAE,EAAI;EAC3BA,EAAAA,EAAE,CAACpB,aAAD,CAAF,GAAoB,IAApB;EACA,SAAOoB,EAAP;EACD,CAHM;;EC7DP,IAAMc,kBAAkB,GAAG,GAA3B;;EACA,IAAMC,IAAI,GAAG,SAAPA,IAAO;EAAA,SAAM,IAAIC,OAAJ,CAAY,UAAAC,OAAO;EAAA,WAAIlE,UAAU,CAACkE,OAAD,CAAd;EAAA,GAAnB,CAAN;EAAA,CAAb;;EAEA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAAApE,GAAG,EAAI;EAC5B,MAAIA,GAAG,YAAYqE,KAAnB,EAA0B;EACxB,WAAO;EACLC,MAAAA,OAAO,EAAEtE,GAAG,CAACsE,OADR;EAELC,MAAAA,KAAK,EAAEvE,GAAG,CAACuE;EAFN,KAAP;EAID;;EACD,MAAI,OAAOvE,GAAP,KAAe,QAAnB,EAA6B;EAC3B,WAAOA,GAAP;EACD;;EACD,SAAO3B,SAAP;EACD,CAXD;;AAaA,EAAe,SAASmG,oBAAT,OAOZ;EAAA,MANDC,8BAMC,QANDA,8BAMC;EAAA,MALDC,YAKC,QALDA,YAKC;EAAA,MAJDC,UAIC,QAJDA,UAIC;EAAA,MAHDC,KAGC,QAHDA,KAGC;EAAA,MAFDC,eAEC,QAFDA,eAEC;EAAA,MADDC,UACC,QADDA,UACC;EACD,MAAIC,WAAW,GAAG,KAAlB;;EAEA,MAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAAApH,CAAC;EAAA,WACzB,CAAC6G,8BAAD,IAAmC,OAAO7G,CAAP,KAAa,UAAhD,GACI8F,YAAY,CAACM,kBAAD,CAAZ,CAAiCpG,CAAjC,CADJ,GAEIA,CAHqB;EAAA,GAA3B;;EAKA,MAAMqH,YAAY,GAAGP,YAAY,IAAI,EAArC;EACA,MAAIQ,UAAU,GAAG,CAAjB;EAEA,MAAMC,kBAAkB,GAAG,EAA3B;EAEA,MAAMC,iBAAiB,GAAG,EAA1B;EACA,MAAMC,cAAc,GAAG,EAAvB;EAEA,MAAMC,mBAAmB,GAAG,EAA5B;EAEA,MAAMC,kBAAkB,GAAG,EAA3B;AACA,EAEA,MAAMC,YAAY,GAAG,EAArB;EAEA,MAAMC,cAAc,GAAG,EAAvB;EAEA,MAAMC,iBAAiB,GAAG,EAA1B;EAEA,MAAMC,yBAAyB,GAAG,EAAlC;EACA,MAAMC,iBAAiB,GAAG,EAA1B;EACA,MAAMC,gBAAgB,GAAG,EAAzB;EAEA,MAAMC,aAAa,GAAG,EAAtB;EACA,MAAMC,gBAAgB,GAAG,EAAzB;EAEA,MAAMC,kBAAkB,GAAG,EAA3B;;EAEA,MAAMC,6BAA6B,GAAG,SAAhCA,6BAAgC,CAACrG,OAAD,EAAUsG,UAAV;EAAA,WACpCC,MAAM,CAACC,IAAP,CAAYxG,OAAZ,EAAqByG,OAArB,CAA6B,UAAAC,GAAG,EAAI;EAClC,UAAM/H,KAAK,GAAGqB,OAAO,CAAC0G,GAAD,CAArB;EACA,UAAMtI,IAAI,aAAOkI,UAAP,GAAmBI,GAAnB,EAAV;EACA,UAAMC,IAAI,GAAG;EACXC,QAAAA,MAAM,EAAEN,UADG;EAEXlI,QAAAA,IAAI,EAAJA;EAFW,OAAb;;EAIA,UAAI,OAAOO,KAAP,KAAiB,UAArB,EAAiC;EAC/B,YAAIA,KAAK,CAACiD,YAAD,CAAT,EAAyB;EACvB,cAAMiF,IAAI,gBAAczI,IAAI,CAAC0I,IAAL,CAAU,GAAV,CAAxB;EACAnI,UAAAA,KAAK,CAACgD,gBAAD,CAAL,GAA0BkF,IAA1B;EACAlI,UAAAA,KAAK,CAACsD,UAAD,CAAL,GAAoB0E,IAApB,CAHuB;;EAMvB,cAAMI,aAAa,GAAGpI,KAAtB;EACAoI,UAAAA,aAAa,CAACpF,gBAAD,CAAb,GAAkCkF,IAAlC;EACAlB,UAAAA,kBAAkB,CAACkB,IAAD,CAAlB,GAA2BE,aAA3B;AACAC;EAGA,cAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAAAC,OAAO,EAAI;EAC/B,gBAAMC,MAAM,GAAGjC,UAAU,CAACtE,QAAX,CAAoB;EACjCwG,cAAAA,IAAI,EAAEL,aAAa,CAACpF,gBAAD,CADc;EAEjCuF,cAAAA,OAAO,EAAPA;EAFiC,aAApB,CAAf;EAIA,mBAAOC,MAAP;EACD,WAND;;EAOAF,UAAAA,aAAa,CAACtF,gBAAD,CAAb,GAAkCkF,IAAlC;EACArB,UAAAA,iBAAiB,CAACqB,IAAD,CAAjB,GAA0BI,aAA1B;EACAvI,UAAAA,GAAG,CAACN,IAAD,EAAOqH,cAAP,EAAuBwB,aAAvB,CAAH;EArBuB,cAuBf1D,MAvBe,GAuBJ5E,KAAK,CAACkD,iBAAD,CAvBD,CAuBf0B,MAvBe;;EAwBvB,cAAIA,MAAM,IAAIA,MAAM,CAAC8D,QAArB,EAA+B;EAC7BtB,YAAAA,yBAAyB,CAACuB,IAA1B,CAA+B3I,KAA/B;EACD;EACF,SA3BD,MA2BO,IAAIA,KAAK,CAAC+D,WAAD,CAAT,EAAwB;EAC7B,cAAMmE,KAAI,eAAazI,IAAI,CAAC0I,IAAL,CAAU,GAAV,CAAvB;;EACAnI,UAAAA,KAAK,CAACgD,gBAAD,CAAL,GAA0BkF,KAA1B,CAF6B;;EAK7B,cAAMhE,MAAM,GAAG,SAATA,MAAS,CAAAqE,OAAO,EAAI;EACxB,mBAAOvI,KAAK,CAACR,GAAG,CAACmI,UAAD,EAAab,cAAb,CAAJ,EAAkCyB,OAAlC,EAA2C;EACrD;EACAtG,cAAAA,QAAQ,EAAEsE,UAAU,CAACtE,QAFgC;EAGrDtB,cAAAA,QAAQ,EAAE;EAAA,uBAAMnB,GAAG,CAACmI,UAAD,EAAapB,UAAU,CAAC5F,QAAX,EAAb,CAAT;EAAA,eAH2C;EAIrDiI,cAAAA,eAAe,EAAE;EAAA,uBAAM9B,cAAN;EAAA,eAJoC;EAKrD+B,cAAAA,aAAa,EAAEtC,UAAU,CAAC5F,QAL2B;EAMrDyF,cAAAA,UAAU,EAAVA,UANqD;EAOrD4B,cAAAA,IAAI,EAAJA;EAPqD,aAA3C,CAAZ;EASD,WAVD;;EAWAjI,UAAAA,GAAG,CAACN,IAAD,EAAOwH,YAAP,EAAqB/C,MAArB,CAAH,CAhB6B;;EAmB7B,cAAMoE,cAAa,GAAG,SAAhBA,cAAgB,CAAAC,OAAO;EAAA,mBAC3B7C,IAAI,GACDoD,IADH,CACQ;EAAA,qBACJvC,UAAU,CAACtE,QAAX,CAAoB;EAClBwG,gBAAAA,IAAI,EAAKP,KAAL,cADc;EAElBK,gBAAAA,OAAO,EAAPA;EAFkB,eAApB,CADI;EAAA,aADR,EAOGO,IAPH,CAOQ;EAAA,qBAAMvC,UAAU,CAACtE,QAAX,CAAoB;EAAA,uBAAMiC,MAAM,CAACqE,OAAD,CAAZ;EAAA,eAApB,CAAN;EAAA,aAPR,EAQGO,IARH,CAQQ,UAAAN,MAAM,EAAI;EACdjC,cAAAA,UAAU,CAACtE,QAAX,CAAoB;EAClBwG,gBAAAA,IAAI,EAAKP,KAAL,gBADc;EAElBK,gBAAAA,OAAO,EAAPA;EAFkB,eAApB;EAIA,qBAAOC,MAAP;EACD,aAdH,EAeGO,KAfH,CAeS,UAAAtH,GAAG,EAAI;EACZ8E,cAAAA,UAAU,CAACtE,QAAX,CAAoB;EAClBwG,gBAAAA,IAAI,EAAKP,KAAL,aADc;EAElBK,gBAAAA,OAAO,EAAPA,OAFkB;EAGlBzH,gBAAAA,KAAK,EAAE+E,cAAc,CAACpE,GAAD;EAHH,eAApB;EAKA,oBAAMA,GAAN;EACD,aAtBH,CAD2B;EAAA,WAA7B;;EAyBA6G,UAAAA,cAAa,CAACtF,gBAAD,CAAb,GAAkCkF,KAAlC;EACArB,UAAAA,iBAAiB,CAACqB,KAAD,CAAjB,GAA0BI,cAA1B;EACAvI,UAAAA,GAAG,CAACN,IAAD,EAAOqH,cAAP,EAAuBwB,cAAvB,CAAH;EA9C6B,cAgDrB1D,OAhDqB,GAgDV5E,KAAK,CAACgE,gBAAD,CAhDK,CAgDrBY,MAhDqB;;EAiD7B,cAAIA,OAAM,IAAIA,OAAM,CAAC8D,QAArB,EAA+B;EAC7BtB,YAAAA,yBAAyB,CAACuB,IAA1B,CAA+B3I,KAA/B;EACD;EACF,SApDM,MAoDA,IAAIA,KAAK,CAACmD,cAAD,CAAT,EAA2B;EAChC,cAAIzD,MAAM,GAAGF,GAAG,CAACmI,UAAD,EAAajB,YAAb,CAAhB;;EACA,cAAI,CAAChH,MAAL,EAAa;EACXA,YAAAA,MAAM,GAAG,EAAT;EACAK,YAAAA,GAAG,CAAC4H,UAAD,EAAajB,YAAb,EAA2BhH,MAA3B,CAAH;EACD;;EACD,cAAMkF,QAAM,GAAG5E,KAAK,CAACoD,oBAAD,CAApB;EANgC,cAOxB2B,cAPwB,GAOLH,QAPK,CAOxBG,cAPwB;EAQhC,cAAMiE,gBAAgB,GAAG7D,YAAY,CAAC,CAAD,CAAZ,CAAgBnF,KAAhB,CAAzB;EACA,cAAIiJ,KAAJ;;EACA,cAAMC,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAAC,CAAC,EAAI;EAClCvB,YAAAA,MAAM,CAACwB,cAAP,CAAsBD,CAAtB,EAAyBpB,GAAzB,EAA8B;EAC5BsB,cAAAA,YAAY,EAAE,IADc;EAE5B7J,cAAAA,GAAG,EAAE,iBAAM;EACT,oBAAM8J,UAAU,GAAG9C,WAAW,GAC1BD,UAAU,CAACgD,YADe,GAE1BhD,UAAU,CAAC5F,QAAX,EAFJ;;EAGA,oBAAMC,KAAK,GAAGpB,GAAG,CAACmI,UAAD,EAAa2B,UAAb,CAAjB;;EACA,oBAAME,MAAM,GAAGzE,cAAc,CAAC0E,GAAf,CAAmB,UAAAC,QAAQ;EAAA,yBACxCA,QAAQ,CAAC9I,KAAD,EAAQ0I,UAAR,CADgC;EAAA,iBAA3B,CAAf;EAGAL,gBAAAA,KAAK,GAAGD,gBAAgB,MAAhB,SAAoBQ,MAApB,CAAR;EACA,uBAAOP,KAAP;EACD,eAZ2B;EAa5BlJ,cAAAA,GAAG,EAAE,eAAM;EACT,sBAAM,IAAI+F,KAAJ,yCACiCrG,IAAI,CAAC0I,IAAL,CACnC,GADmC,CADjC,8DAAN;EAKD;EAnB2B,aAA9B;EAqBD,WAtBD;;EAuBAe,UAAAA,sBAAsB,CAACxJ,MAAD,CAAtB;EACAK,UAAAA,GAAG,CAACN,IAAD,EAAOmH,kBAAP,EAA2BsC,sBAA3B,CAAH;EACD,SAnCM,MAmCA,IAAIlJ,KAAK,CAAC4D,cAAD,CAAT,EAA2B;EAChC+C,UAAAA,UAAU,IAAI,CAAd;EACA,cAAMgD,kBAAkB,GAAGhD,UAA3B;EAFgC,sCAGP3G,KAAK,CAAC6D,oBAAD,CAHE;EAAA,cAGxB0B,IAHwB,yBAGxBA,IAHwB;EAAA,cAGlBX,QAHkB,yBAGlBA,MAHkB;EAIhC,cAAMgF,cAAc,GAClBrE,IAAI,IAAIjG,KAAK,CAACC,OAAN,CAAcgG,IAAd,CAAR,GACIA,IAAI,CAACkE,GAAL,CAAS,UAAAI,CAAC;EAAA,mBAAI1E,YAAY,CAAC,CAAD,CAAZ,CAAgB0E,CAAhB,CAAJ;EAAA,WAAV,CADJ,GAEI,CAAC,UAAAjJ,KAAK;EAAA,mBAAIA,KAAJ;EAAA,WAAN,CAHN;EAIA,cAAMkJ,KAAK,GACT,OAAOlF,QAAP,KAAkB,QAAlB,IACA,OAAOA,QAAM,CAACkF,KAAd,KAAwB,QADxB,IAEAlF,QAAM,CAACkF,KAAP,GAAe,CAFf,GAGIlF,QAAM,CAACmF,MAHX,GAII,CALN;EAMA,cAAMC,gBAAgB,GAAG7E,YAAY,CAAC2E,KAAD,CAAZ,CAAoB;EAAA,8CAAIG,CAAJ;EAAIA,cAAAA,CAAJ;EAAA;;EAAA,mBAC3CjK,KAAK,CACHiK,CAAC,CAACC,KAAF,CAAQ,CAAR,EAAWN,cAAc,CAAC1J,MAA1B,CADG,EAEH+J,CAAC,CAACC,KAAF,CAAQN,cAAc,CAAC1J,MAAvB,CAFG,CADsC;EAAA,WAApB,CAAzB;EAMA,cAAIiK,SAAS,GAAG,CAAhB;EAEA;;;;;;;EAMA,cAAMC,iCAAiC,GAAG,SAApCA,iCAAoC,GAAM;EAC9C,gBAAMC,eAAe,GAAGlF,YAAY,CAAC,CAAD,CAAZ,CAAgB,YAAM;EAC5CgF,cAAAA,SAAS,IAAI,CAAb;EACA,qBAAOA,SAAP;EACD,aAHuB,CAAxB;;EAIA,gBAAMG,2BAA2B,GAAG,SAA9BA,2BAA8B,CAAAhB,UAAU,EAAI;EAChD,kBAAMiB,UAAU,GAAG/K,GAAG,CAACmI,UAAD,EAAa2B,UAAb,CAAtB;;EACA,kBAAMkB,iBAAiB,GAAGZ,cAAc,CAACjK,MAAf,CACxB,UAACC,GAAD,EAAM6K,WAAN,EAAsB;EACpB7K,gBAAAA,GAAG,CAAC+I,IAAJ,CAAS8B,WAAW,CAACF,UAAD,EAAajB,UAAb,CAApB;EACA,uBAAO1J,GAAP;EACD,eAJuB,EAKxB,EALwB,CAA1B;EAOA,qBAAOyK,eAAe,MAAf,SAAmBG,iBAAnB,CAAP;EACD,aAVD;;EAWA,mBAAOF,2BAAP;EACD,WAjBD;EAmBA;;;;;;;EAKA,cAAMI,cAAc,GAAG,SAAjBA,cAAiB,GAAM;EAC3B,gBAAMpF,QAAQ,GAAG,SAAXA,QAAW,GAAoB;EACnC,kBAAMgE,UAAU,GAAG/C,UAAU,CAAC5F,QAAX,EAAnB;;EACA,kBAAM4J,UAAU,GAAG/K,GAAG,CAACmI,UAAD,EAAa2B,UAAb,CAAtB;;EACA,kBAAMqB,iBAAiB,GAAGf,cAAc,CAACjK,MAAf,CACxB,UAACC,GAAD,EAAM6K,WAAN;EAAA,iCACK7K,GADL,GAEE6K,WAAW,CAACF,UAAD,EAAajB,UAAb,CAFb;EAAA,eADwB,EAKxB,EALwB,CAA1B;;EAHmC,iDAAhBsB,WAAgB;EAAhBA,gBAAAA,WAAgB;EAAA;;EAUnC,qBAAOZ,gBAAgB,MAAhB,SAAoBW,iBAAiB,CAACE,MAAlB,CAAyBD,WAAzB,CAApB,CAAP;EACD,aAXD;;EAYAtF,YAAAA,QAAQ,CAACxB,mBAAD,CAAR,GAAgC;EAC9BwG,cAAAA,2BAA2B,EAAEF,iCAAiC,EADhC;EAE9BM,cAAAA,cAAc,EAAdA,cAF8B;EAG9B1C,cAAAA,IAAI,EAAJA,IAH8B;EAI9BrB,cAAAA,UAAU,EAAEgD;EAJkB,aAAhC;EAMA,mBAAOrE,QAAP;EACD,WApBD;;EAqBA,cAAMA,QAAQ,GAAGoF,cAAc,EAA/B;EACAnD,UAAAA,aAAa,CAACZ,UAAD,CAAb,GAA4BrB,QAA5B;EACAvF,UAAAA,GAAG,CAACN,IAAD,EAAOiH,YAAP,EAAqBpB,QAArB,CAAH;EACD,SA5EM,MA4EA,IAAItF,KAAK,CAAC2D,YAAD,CAAT,EAAyB;EAC9B3D,UAAAA,KAAK,CAAC0D,iBAAD,CAAL,GAA2B;EAAEiE,YAAAA,UAAU,EAAVA,UAAF;EAAcI,YAAAA,GAAG,EAAHA,GAAd;EAAmB+C,YAAAA,QAAQ,EAAE;EAA7B,WAA3B;EACAtD,UAAAA,gBAAgB,CAACmB,IAAjB,CAAsB3I,KAAtB;EACD,SAHM,MAGA,IAAIA,KAAK,CAACuD,aAAD,CAAT,EAA0B;EAC/B2D,UAAAA,cAAc,CAACyB,IAAf,CAAoB;EAAElJ,YAAAA,IAAI,EAAJA,IAAF;EAAQ+F,YAAAA,OAAO,EAAExF;EAAjB,WAApB;EACD,SAFM,MAEA,IAAIA,KAAK,CAACqD,YAAD,CAAT,EAAyB;EAC9B8D,UAAAA,iBAAiB,CAACwB,IAAlB,CAAuB3I,KAAvB;EACAA,UAAAA,KAAK,CAACsD,UAAD,CAAL,GAAoB0E,IAApB;EACD,SAHM,MAGA,AAA2C;EAChD;EACAtF,UAAAA,OAAO,CAACC,IAAR,2CAC0ClD,IAAI,CAAC0I,IAAL,CACtC,GADsC,CAD1C;EAKD;EACF,OA/MD,MA+MO,IAAI/I,aAAa,CAACY,KAAD,CAAb,IAAwB4H,MAAM,CAACC,IAAP,CAAY7H,KAAZ,EAAmBE,MAAnB,GAA4B,CAAxD,EAA2D;EAChE,YAAM6K,QAAQ,GAAGvL,GAAG,CAACC,IAAD,EAAOiH,YAAP,CAApB;;EACA,YAAIqE,QAAQ,IAAI,IAAhB,EAAsB;EACpBhL,UAAAA,GAAG,CAACN,IAAD,EAAOiH,YAAP,EAAqB,EAArB,CAAH;EACD;;EACDgB,QAAAA,6BAA6B,CAAC1H,KAAD,EAAQP,IAAR,CAA7B;EACD,OANM,MAMA;EACL;EACA,YAAMuL,gBAAgB,GAAGxL,GAAG,CAACmI,UAAD,EAAaxB,YAAb,CAA5B;;EACA,YAAI6E,gBAAgB,IAAIjD,GAAG,IAAIiD,gBAA/B,EAAiD;EAC/CjL,UAAAA,GAAG,CAACN,IAAD,EAAOiH,YAAP,EAAqBsE,gBAAgB,CAACjD,GAAD,CAArC,CAAH;EACD,SAFD,MAEO;EACLhI,UAAAA,GAAG,CAACN,IAAD,EAAOiH,YAAP,EAAqB1G,KAArB,CAAH;EACD;EACF;EACF,KArOD,CADoC;EAAA,GAAtC;;EAwOA0H,EAAAA,6BAA6B,CAACrB,KAAD,EAAQ,EAAR,CAA7B;EAEAe,EAAAA,yBAAyB,CAACU,OAA1B,CAAkC,UAAAmD,cAAc,EAAI;EAAA,gBAG9CA,cAAc,CAAC/H,iBAAD,CAAd,IAAqC+H,cAAc,CAACjH,gBAAD,CAHL;EAAA,QAEtC0E,QAFsC,SAEhD9D,MAFgD,CAEtC8D,QAFsC;;EAIlD,QAAIwC,UAAJ;;EAEA,QAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAAAzL,MAAM,EAAI;EAChC,UACE,OAAOA,MAAP,KAAkB,UAAlB,IACAA,MAAM,CAACsD,gBAAD,CADN,IAEA6D,iBAAiB,CAACnH,MAAM,CAACsD,gBAAD,CAAP,CAHnB,EAIE;EACA,YAAItD,MAAM,CAACqE,WAAD,CAAV,EAAyB;EACvBmH,UAAAA,UAAU,GAAGE,iBAAA,CAA0B1L,MAA1B,CAAb;EACD,SAFD,MAEO;EACLwL,UAAAA,UAAU,GAAGxL,MAAM,CAACsD,gBAAD,CAAnB;EACD;EACF,OAVD,MAUO,IAAI,OAAOtD,MAAP,KAAkB,QAAtB,EAAgC;EACrCwL,QAAAA,UAAU,GAAGxL,MAAb;EACD;;EACD,UAAM2L,WAAW,GAAGhE,iBAAiB,CAAC6D,UAAD,CAAjB,IAAiC,EAArD;EACAG,MAAAA,WAAW,CAAC1C,IAAZ,CAAiB9B,iBAAiB,CAACoE,cAAc,CAACjI,gBAAD,CAAf,CAAlC;EACAqE,MAAAA,iBAAiB,CAAC6D,UAAD,CAAjB,GAAgCG,WAAhC;EACD,KAjBD;;EAmBA,QAAI/L,KAAK,CAACC,OAAN,CAAcmJ,QAAd,CAAJ,EAA6B;EAC3BA,MAAAA,QAAQ,CAACZ,OAAT,CAAiBqD,eAAjB;EACD,KAFD,MAEO;EACLA,MAAAA,eAAe,CAACzC,QAAD,CAAf;EACD;EACF,GA9BD;EAgCAlB,EAAAA,gBAAgB,CAACM,OAAjB,CAAyB,UAAAxC,QAAQ,EAAI;EACnCA,IAAAA,QAAQ,CAAC7B,eAAD,CAAR,GAA4B,UAAA7C,KAAK;EAAA,aAAI6F,iBAAiB,CAACnB,QAAQ,CAAC1E,KAAD,CAAT,CAArB;EAAA,KAAjC;EACD,GAFD;EAIAuG,EAAAA,iBAAiB,CAACW,OAAlB,CAA0B,UAAAwD,GAAG,EAAI;EAC/BA,IAAAA,GAAG,CAACC,SAAJ,GAAgBD,GAAG,CAACC,SAAJ,IAAiB,EAAjC;;EAEA,QAAMC,EAAE,GAAG,SAALA,EAAK,CAAC9L,MAAD,EAAS+L,OAAT,EAAqB;EAC9B,UAAI,OAAOA,OAAP,KAAmB,UAAvB,EAAmC;EACjC;EACD;;EAED,UAAMzD,IAAI,GAAGsD,GAAG,CAAChI,UAAD,CAAhB;EACAmI,MAAAA,OAAO,CAACnI,UAAD,CAAP,GAAsB0E,IAAtB;;EAEA,UAAI,CAACyD,OAAO,CAACxI,YAAD,CAAR,IAA0B,CAACwI,OAAO,CAAC1H,WAAD,CAAtC,EAAqD;EACnD,QAA2C;EACzC;EACArB,UAAAA,OAAO,CAACC,IAAR,sHACgHqF,IAAI,CAACvI,IAAL,CAAU0I,IAAV,CAC5G,GAD4G,CADhH;EAKD;;EACD;EACD;;EAED,UAAIuD,gBAAJ;;EAEA,UACE,OAAOhM,MAAP,KAAkB,UAAlB,IACAA,MAAM,CAACsD,gBAAD,CADN,IAEA6D,iBAAiB,CAACnH,MAAM,CAACsD,gBAAD,CAAP,CAHnB,EAIE;EACA,YAAItD,MAAM,CAACqE,WAAD,CAAV,EAAyB;EACvB2H,UAAAA,gBAAgB,GAAGN,iBAAA,CAA0B1L,MAA1B,CAAnB;EACD,SAFD,MAEO;EACLgM,UAAAA,gBAAgB,GAAGhM,MAAM,CAACsD,gBAAD,CAAzB;EACD;EACF,OAVD,MAUO,IAAI,OAAOtD,MAAP,KAAkB,QAAtB,EAAgC;EACrCgM,QAAAA,gBAAgB,GAAGhM,MAAnB;EACD;;EAED,UAAIgM,gBAAJ,EAAsB;EACpB,YAAID,OAAO,CAAC1H,WAAD,CAAX,EAA0B;EACxB0D,UAAAA,kBAAkB,CAACiE,gBAAD,CAAlB,GACEjE,kBAAkB,CAACiE,gBAAD,CAAlB,IAAwC,EAD1C;EAEAjE,UAAAA,kBAAkB,CAACiE,gBAAD,CAAlB,CAAqC/C,IAArC,CAA0C8C,OAA1C;EACD,SAJD,MAIO;EACL1E,UAAAA,mBAAmB,CAAC2E,gBAAD,CAAnB,GACE3E,mBAAmB,CAAC2E,gBAAD,CAAnB,IAAyC,EAD3C;EAEA3E,UAAAA,mBAAmB,CAAC2E,gBAAD,CAAnB,CAAsC/C,IAAtC,CAA2C;EACzClJ,YAAAA,IAAI,EAAEuI,IAAI,CAACC,MAD8B;EAEzCwD,YAAAA,OAAO,EAAPA;EAFyC,WAA3C;EAID;;EACDH,QAAAA,GAAG,CAACC,SAAJ,CAAcG,gBAAd,IAAkCJ,GAAG,CAACC,SAAJ,CAAcG,gBAAd,KAAmC,EAArE;EACAJ,QAAAA,GAAG,CAACC,SAAJ,CAAcG,gBAAd,EAAgC/C,IAAhC,CAAqC8C,OAArC;EACD;EACF,KApDD;;EAqDAH,IAAAA,GAAG,CAACE,EAAD,CAAH;EACD,GAzDD;;EA2DA,MAAMG,kBAAkB,GAAG,SAArBA,kBAAqB,CAAC/K,KAAD,EAAQ0E,QAAR,EAAqB;EAAA,gCACRA,QAAQ,CAAC5B,iBAAD,CADA;EAAA,QACtCiE,UADsC,yBACtCA,UADsC;EAAA,QAC1BI,GAD0B,yBAC1BA,GAD0B;EAAA,QACrB+C,QADqB,yBACrBA,QADqB;;EAE9C,QAAIA,QAAJ,EAAc;EACZ,aAAOlK,KAAP;EACD;;EACD,QAAML,YAAY,GAAG+E,QAAQ,CAAC9B,wBAAD,CAA7B;EAEA,QAAMoI,sBAAsB,GAAGrL,YAAY,GACvCA,YAAY,CAACZ,MAAb,CAAoBgM,kBAApB,EAAwC/K,KAAxC,CADuC,GAEvCA,KAFJ;EAIA,QAAIW,QAAQ,GAAGqK,sBAAf;;EAEA,QAAIjE,UAAU,CAACzH,MAAX,GAAoB,CAAxB,EAA2B;EACzB,UAAMR,MAAM,GAAGF,GAAG,CAACmI,UAAD,EAAaiE,sBAAb,CAAlB;;EACA,UAAIlM,MAAJ,EAAY;EACV,YACE,CAAC4F,QAAQ,CAACuG,SAAV,IACAvG,QAAQ,CAACuG,SAAT,KAAuBrM,GAAG,CAACmI,UAAD,EAAa/G,KAAb,CAF5B,EAGE;EACA,cAAMkL,QAAQ,GAAGxG,QAAQ,CAAC7B,eAAD,CAAR,CAA0B/D,MAA1B,CAAjB;EACA6B,UAAAA,QAAQ,GAAGwK,gBAAO,CAACnL,KAAD,EAAQ,UAAAoL,KAAK,EAAI;EACjC,gBAAMC,YAAY,GAAGzM,GAAG,CAACmI,UAAD,EAAaqE,KAAb,CAAxB;;EACAC,YAAAA,YAAY,CAAClE,GAAD,CAAZ,GAAoB+D,QAApB;EACD,WAHiB,CAAlB;EAIAxG,UAAAA,QAAQ,CAACuG,SAAT,GAAqBrM,GAAG,CAACmI,UAAD,EAAapG,QAAb,CAAxB;EACD;EACF;EACF,KAfD,MAeO,IAAI,CAAC+D,QAAQ,CAACuG,SAAV,IAAuBvG,QAAQ,CAACuG,SAAT,KAAuBjL,KAAlD,EAAyD;EAC9D,UAAMkL,SAAQ,GAAGxG,QAAQ,CAAC7B,eAAD,CAAR,CAA0BmI,sBAA1B,CAAjB;;EACArK,MAAAA,QAAQ,GAAGwK,gBAAO,CAACnL,KAAD,EAAQ,UAAAoL,KAAK,EAAI;EACjCA,QAAAA,KAAK,CAACjE,GAAD,CAAL,GAAa+D,SAAb;EACD,OAFiB,CAAlB;EAGAxG,MAAAA,QAAQ,CAACuG,SAAT,GAAqBtK,QAArB;EACD;;EAED+D,IAAAA,QAAQ,CAAC5B,iBAAD,CAAR,CAA4BoH,QAA5B,GAAuC,IAAvC;EACA,WAAOvJ,QAAP;EACD,GAtCD;;EAwCA,MAAM2K,YAAY,GAAG,SAAfA,YAAe,CAAAtL,KAAK;EAAA,WACxB4G,gBAAgB,CAAC7H,MAAjB,CAAwBgM,kBAAxB,EAA4C/K,KAA5C,CADwB;EAAA,GAA1B;;EAGA,MAAMuL,aAAa,GAAG,SAAhBA,aAAgB,GAAM;EAC1B,QAAMC,sBAAsB,GAAG,SAAzBA,sBAAyB,CAACxL,KAAD,EAAQsD,MAAR,EAAgBkE,aAAhB,EAA+B3I,IAA/B,EAAwC;EACrE,UAAM4B,OAAO,GAAG7B,GAAG,CAACC,IAAD,EAAOmB,KAAP,CAAnB;;EACA,UAAMyL,YAAY,GAChB5M,IAAI,CAACS,MAAL,KAAgB,CAAhB,GACI6L,gBAAO,CAACnL,KAAD,EAAQ,UAAA0L,MAAM;EAAA,eAAIlE,aAAa,CAACkE,MAAD,EAASpI,MAAM,CAACqE,OAAhB,CAAjB;EAAA,OAAd,CADX,GAEIwD,gBAAO,CAACnL,KAAD,EAAQ,UAAAoL,KAAK,EAAI;EACtBjM,QAAAA,GAAG,CACDqI,aAAa,CAAC9E,UAAD,CAAb,CAA0B2E,MADzB,EAED+D,KAFC,EAGDD,gBAAO,CAAC1K,OAAD,EAAU,UAAAiL,MAAM;EAAA,iBACrBlE,aAAa,CAACkE,MAAD,EAASpI,MAAM,CAACqE,OAAhB,CADQ;EAAA,SAAhB,CAHN,CAAH;EAOD,OARM,CAHb;;EAaA,UAAI8D,YAAY,KAAKzL,KAArB,EAA4B;EAC1B,YAAM2L,wBAAwB,GAAG/M,GAAG,CAACC,IAAD,EAAOmH,kBAAP,CAApC;;EACA,YAAI2F,wBAAJ,EAA8B;EAC5B,cAAMC,cAAc,GAAGhN,GAAG,CAACC,IAAD,EAAO4M,YAAP,CAA1B;;EACAzE,UAAAA,MAAM,CAACC,IAAP,CAAY0E,wBAAZ,EAAsCzE,OAAtC,CAA8C,UAAAC,GAAG,EAAI;EACnDwE,YAAAA,wBAAwB,CAACxE,GAAD,CAAxB,CAA8ByE,cAA9B;EACD,WAFD;EAGD;EACF;;EAED,aAAOH,YAAP;EACD,KA1BD;;EA4BA,QAAMI,iBAAiB,GAAG,SAApBA,iBAAoB,CAAC7L,KAAD,EAAQsD,MAAR,EAAmB;EAC3C,UAAMkE,aAAa,GAAGpB,kBAAkB,CAAC9C,MAAM,CAACuE,IAAR,CAAxC;;EACA,UAAIL,aAAJ,EAAmB;EACjB,eAAOgE,sBAAsB,CAC3BxL,KAD2B,EAE3BsD,MAF2B,EAG3BkE,aAH2B,EAI3BA,aAAa,CAAC9E,UAAD,CAAb,CAA0B2E,MAJC,CAA7B;EAMD;;EACD,aAAOrH,KAAP;EACD,KAXD;;EAaA,QAAM8L,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAC9L,KAAD,EAAQsD,MAAR,EAAmB;EAC7C,UAAMxE,MAAM,GACVwE,MAAM,CAACuE,IAAP,KAAgB,eAAhB,GAAkCvE,MAAM,CAACD,UAAzC,GAAsDC,MAAM,CAACuE,IAD/D;EAEA,UAAMkE,eAAe,GAAG5F,mBAAmB,CAACrH,MAAD,CAA3C;;EACA,UAAIiN,eAAJ,EAAqB;EACnB,YAAMC,YAAY,GAChB1I,MAAM,CAACuE,IAAP,KAAgB,eAAhB,GACI;EAAEA,UAAAA,IAAI,EAAE/I,MAAR;EAAgB6I,UAAAA,OAAO,EAAErE,MAAM,CAACqE;EAAhC,SADJ,GAEIrE,MAHN;EAIA,eAAOyI,eAAe,CAAChN,MAAhB,CACL,UAAC4B,QAAD;EAAA,cAAa9B,IAAb,SAAaA,IAAb;EAAA,cAAmBgM,OAAnB,SAAmBA,OAAnB;EAAA,iBACEW,sBAAsB,CAAC7K,QAAD,EAAWqL,YAAX,EAAyBnB,OAAzB,EAAkChM,IAAlC,CADxB;EAAA,SADK,EAGLmB,KAHK,CAAP;EAKD;;EACD,aAAOA,KAAP;EACD,KAhBD;;EAkBA,QAAMiM,wBAAwB,GAAG,SAA3BA,wBAA2B,CAACjM,KAAD,EAAQsD,MAAR,EAAmB;EAClD,aAAO6H,gBAAO,CAACnL,KAAD,EAAQ,UAAAoL,KAAK,EAAI;EAC7B9E,QAAAA,cAAc,CAACY,OAAf,CAAuB,iBAA+B;EAAA,cAAtBgF,CAAsB,SAA5BrN,IAA4B;EAAA,cAAVsN,GAAU,SAAnBvH,OAAmB;;EACpD,cAAMnE,OAAO,GAAG7B,GAAG,CAACsN,CAAD,EAAId,KAAJ,CAAnB;;EACAjM,UAAAA,GAAG,CAAC+M,CAAD,EAAId,KAAJ,EAAWe,GAAG,CAAC1L,OAAD,EAAU6C,MAAV,CAAd,CAAH;EACD,SAHD;EAID,OALa,CAAd;EAMD,KAPD;;EASA,QAAI8I,SAAS,GAAG,IAAhB;;EAEA,QAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAAArM,KAAK,EAAI;EAC9B,UAAMsM,mBAAmB,GAAGhB,YAAY,CAACtL,KAAD,CAAxC;EACAoM,MAAAA,SAAS,GAAG,KAAZ;EACAxF,MAAAA,gBAAgB,CAACM,OAAjB,CAAyB,UAAAxC,QAAQ,EAAI;EACnCA,QAAAA,QAAQ,CAAC5B,iBAAD,CAAR,CAA4BoH,QAA5B,GAAuC,KAAvC;EACD,OAFD;EAGA,aAAOoC,mBAAP;EACD,KAPD;;EASA,QAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAAvM,KAAK,EAAI;EAChC,UAAMwM,SAAS,GAAGxF,MAAM,CAACyF,MAAP,CAAc9F,aAAd,CAAlB;EACA,aAAOwE,gBAAO,CAACnL,KAAD,EAAQ,UAAAoL,KAAK,EAAI;EAC7BoB,QAAAA,SAAS,CAACtF,OAAV,CAAkB,UAAAxC,QAAQ,EAAI;EAC5B,cAAMgI,aAAa,GAAGhI,QAAQ,CAACxB,mBAAD,CAA9B;;EACA,cAAIwJ,aAAa,CAACC,gBAAd,IAAkC,IAAtC,EAA4C;EAC1CD,YAAAA,aAAa,CAACC,gBAAd,GAAiCD,aAAa,CAAChD,2BAAd,CAC/B1J,KAD+B,CAAjC;EAGD,WAJD,MAIO;EACL,gBAAM4M,gBAAgB,GAAGF,aAAa,CAAChD,2BAAd,CACvB1J,KADuB,CAAzB;;EAGA,gBAAI0M,aAAa,CAACC,gBAAd,KAAmCC,gBAAvC,EAAyD;EACvD,kBAAMC,WAAW,GAAGH,aAAa,CAAC5C,cAAd,EAApB;EACA+C,cAAAA,WAAW,CAACH,aAAa,CAACC,gBAAf,CAAX,GAA8CC,gBAA9C;EACAjG,cAAAA,aAAa,CAAC+F,aAAa,CAAC3G,UAAf,CAAb,GAA0C8G,WAA1C;EACA1N,cAAAA,GAAG,CAACuN,aAAa,CAACtF,IAAd,CAAmBvI,IAApB,EAA0BuM,KAA1B,EAAiCyB,WAAjC,CAAH;EACD;EACF;EACF,SAjBD;EAkBD,OAnBa,CAAd;EAoBD,KAtBD;;EAwBA,QAAMC,WAAW,GAAG,SAAdA,WAAc,CAAC9M,KAAD,EAAQsD,MAAR,EAAmB;EACrCsC,MAAAA,WAAW,GAAG,IAAd;EACA,UAAMmH,iBAAiB,GAAGlB,iBAAiB,CAAC7L,KAAD,EAAQsD,MAAR,CAA3C;EACA,UAAM0J,mBAAmB,GAAGlB,mBAAmB,CAC7CiB,iBAD6C,EAE7CzJ,MAF6C,CAA/C;EAIA,UAAM2J,wBAAwB,GAAGhB,wBAAwB,CACvDe,mBADuD,EAEvD1J,MAFuD,CAAzD;EAIA,UAAM4J,gBAAgB,GACpBlN,KAAK,KAAKiN,wBAAV,IAAsCb,SAAtC,GACIC,cAAc,CAACY,wBAAD,CADlB,GAEIA,wBAHN;EAIA,UAAMrF,MAAM,GAAG2E,gBAAgB,CAACW,gBAAD,CAA/B;EACAtH,MAAAA,WAAW,GAAG,KAAd;EACA,aAAOgC,MAAP;EACD,KAlBD;;EAoBA,WAAOkF,WAAP;EACD,GA7HD;;EA+HA,SAAO;EACL5G,IAAAA,cAAc,EAAdA,cADK;EAELC,IAAAA,mBAAmB,EAAnBA,mBAFK;EAGLL,IAAAA,YAAY,EAAZA,YAHK;EAILS,IAAAA,iBAAiB,EAAjBA,iBAJK;EAKLE,IAAAA,iBAAiB,EAAjBA,iBALK;EAMLC,IAAAA,gBAAgB,EAAhBA,gBANK;EAOL9B,IAAAA,OAAO,EAAEc,eAAe,CAAC6F,aAAa,EAAd,CAPnB;EAQL1E,IAAAA,kBAAkB,EAAlBA;EARK,GAAP;EAUD;;ECpkBc,SAASsG,WAAT,CAAqB1H,KAArB,EAA4B2H,OAA5B,EAA0C;EAAA,MAAdA,OAAc;EAAdA,IAAAA,OAAc,GAAJ,EAAI;EAAA;;EAAA,iBAYnDA,OAZmD;EAAA,MAErDC,OAFqD,YAErDA,OAFqD;EAAA,mCAGrDC,QAHqD;EAAA,MAGrDA,QAHqD,kCAG1C,IAH0C;EAAA,uCAIrDhI,8BAJqD;EAAA,MAIrDA,8BAJqD,sCAIpB,KAJoB;EAAA,oCAKrDiI,SALqD;EAAA,MAKrDA,SALqD,mCAKzC,EALyC;EAAA,uCAMrDhI,YANqD;EAAA,MAMrDA,YANqD,sCAMtC,EANsC;EAAA,MAOrDC,UAPqD,YAOrDA,UAPqD;EAAA,qCAQrDgI,UARqD;EAAA,MAQrDA,UARqD,oCAQxC,EARwC;EAAA,sCASrDC,WATqD;EAAA,MASrDA,WATqD,qCASvC,KATuC;EAAA,+BAUrDnG,IAVqD;EAAA,MAU/CoG,SAV+C;EAAA,uCAWrDhI,eAXqD;EAAA,MAWrDA,eAXqD,sCAWnC,UAAAoH,WAAW;EAAA,WAAIA,WAAJ;EAAA,GAXwB;;EAcvD,MAAMa,eAAe,gBAChBlI,KADgB;EAEnBmI,IAAAA,YAAY,EAAEpD,KAAA,CAAc,UAACqD,OAAD,EAAUlG,OAAV,QAAoC;EAAA,UAAf5H,QAAe,QAAfA,QAAe;EAC9D;EACA+B,MAAAA,OAAO,CAACgM,GAAR,CAAYC,IAAI,CAACC,SAAL,CAAejO,QAAQ,EAAvB,EAA2B,IAA3B,EAAiC,CAAjC,CAAZ;EACD,KAHa,CAFK;EAMnBkO,IAAAA,YAAY,EAAEzD,MAAA,CAAe,UAACxK,KAAD,EAAQ2H,OAAR;EAAA,aAAoBA,OAApB;EAAA,KAAf;EANK,IAArB;;EASA,MAAMhC,UAAU,GAAG,EAAnB;EAEA,MAAIuI,aAAa,GAAG,EAApB;;EAEA,MAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAAC3J,KAAD,EAAQmD,OAAR;EAAA,WACpBnD,KAAK,CACH5F,GAAG,CAAC4F,KAAK,CAAC9B,UAAD,CAAL,CAAkB2E,MAAnB,EAA2B1B,UAAU,CAACyI,SAAX,CAAqBlI,cAAhD,CADA,EAEHyB,OAFG,EAGH;EACEtG,MAAAA,QAAQ,EAAEsE,UAAU,CAACtE,QADvB;EAEEtB,MAAAA,QAAQ,EAAE;EAAA,eAAMnB,GAAG,CAAC4F,KAAK,CAAC9B,UAAD,CAAL,CAAkB2E,MAAnB,EAA2B1B,UAAU,CAAC5F,QAAX,EAA3B,CAAT;EAAA,OAFZ;EAGEkI,MAAAA,aAAa,EAAEtC,UAAU,CAAC5F,QAH5B;EAIEyF,MAAAA,UAAU,EAAVA,UAJF;EAKE4B,MAAAA,IAAI,EAAE5C,KAAK,CAAC9B,UAAD;EALb,KAHG,CADe;EAAA,GAAtB;;EAaA,MAAM2L,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAC/G,IAAD,EAAOK,OAAP,EAAmB;EAChD,QAAM2G,gBAAgB,GAAG3I,UAAU,CAACyI,SAAX,CAAqBvH,kBAArB,CAAwCS,IAAxC,CAAzB;EACA,WAAOgH,gBAAgB,IAAIA,gBAAgB,CAAChP,MAAjB,GAA0B,CAA9C,GACHyF,OAAO,CAACwJ,GAAR,CACED,gBAAgB,CAACzF,GAAjB,CAAqB,UAAA2F,eAAe;EAAA,aAClCL,aAAa,CAACK,eAAD,EAAkB7G,OAAlB,CADqB;EAAA,KAApC,CADF,CADG,GAMH5C,OAAO,CAACC,OAAR,EANJ;EAOD,GATD;;EAWA,MAAMyJ,6BAA6B,GAAG,SAAhCA,6BAAgC;EAAA,WAAM,UAAA/M,IAAI;EAAA,aAAI,UAAA4B,MAAM,EAAI;EAC5D,YAAMsE,MAAM,GAAGlG,IAAI,CAAC4B,MAAD,CAAnB;;EACA,YAAIqC,UAAU,CAACyI,SAAX,CAAqBvH,kBAArB,CAAwCvD,MAAM,CAACuE,IAA/C,CAAJ,EAA0D;EACxDwG,UAAAA,sBAAsB,CAAC/K,MAAM,CAACuE,IAAR,EAAcvE,MAAM,CAACqE,OAArB,CAAtB;EACD;;EACD,eAAOC,MAAP;EACD,OAN+C;EAAA,KAAV;EAAA,GAAtC;;EAQA,MAAM8G,gBAAgB,GACpBrB,OAAO,KACNC,QAAQ,IACT,OAAOqB,MAAP,KAAkB,WADjB,IAEDA,MAAM,CAACC,oCAFN,GAGGD,MAAM,CAACC,oCAAP,CAA4C;EAC1CtH,IAAAA,IAAI,EAAEoG;EADoC,GAA5C,CAHH,GAMGmB,aAPG,CADT;;EAUA,MAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAAA9O,KAAK,EAAI;EAClC2F,IAAAA,UAAU,CAACyI,SAAX,GAAuB/I,oBAAoB,CAAC;EAC1CC,MAAAA,8BAA8B,EAA9BA,8BAD0C;EAE1CC,MAAAA,YAAY,EAAEvF,KAF4B;EAG1CwF,MAAAA,UAAU,EAAVA,UAH0C;EAI1CC,MAAAA,KAAK,EAAEkI,eAJmC;EAK1CjI,MAAAA,eAAe,EAAfA,eAL0C;EAM1CC,MAAAA,UAAU,EAAVA;EAN0C,KAAD,CAA3C;EAQD,GATD;;EAWAmJ,EAAAA,kBAAkB,CAACvJ,YAAD,CAAlB;;EAEA,MAAMwJ,yBAAyB,GAAG,SAA5BA,yBAA4B;EAAA,WAAM,UAAArN,IAAI;EAAA,aAAI,UAAA4B,MAAM,EAAI;EACxD,YAAMsE,MAAM,GAAGlG,IAAI,CAAC4B,MAAD,CAAnB;;EACA,YACEA,MAAM,IACNqC,UAAU,CAACyI,SAAX,CAAqB3H,iBAArB,CAAuCnD,MAAM,CAACuE,IAA9C,CADA,IAEAlC,UAAU,CAACyI,SAAX,CAAqB3H,iBAArB,CAAuCnD,MAAM,CAACuE,IAA9C,EAAoDvI,MAApD,GAA6D,CAH/D,EAIE;EACAqG,UAAAA,UAAU,CAACyI,SAAX,CAAqB3H,iBAArB,CAAuCnD,MAAM,CAACuE,IAA9C,EAAoDX,OAApD,CACE,UAAAQ,aAAa,EAAI;EACfA,YAAAA,aAAa,CAACpE,MAAM,CAACqE,OAAR,CAAb;EACD,WAHH;EAKD;;EACD,eAAOC,MAAP;EACD,OAd2C;EAAA,KAAV;EAAA,GAAlC;;EAgBA,MAAMoH,qBAAqB,GAAG,SAAxBA,qBAAwB;EAAA,WAAM,UAAAtN,IAAI;EAAA,aAAI,UAAA4B,MAAM,EAAI;EACpD,YAAImK,WAAJ,EAAiB;EACf,cACEnK,MAAM,IAAI,IAAV,IACC,OAAOA,MAAP,KAAkB,QAAlB,IAA8BA,MAAM,CAACuE,IAAP,KAAgB,eAFjD,EAGE,CAHF,MAKO;EACLqG,YAAAA,aAAa,CAACnG,IAAd,CAAmBzE,MAAnB;EACD;;EACD,iBAAOpE,SAAP;EACD;;EACD,eAAOwC,IAAI,CAAC4B,MAAD,CAAX;EACD,OAbuC;EAAA,KAAV;EAAA,GAA9B;;EAeA,MAAM2L,sBAAsB,GAAG,SAAzBA,sBAAyB;EAAA,WAAM,UAAAvN,IAAI;EAAA,aAAI,UAAA4B,MAAM,EAAI;EACrDqC,QAAAA,UAAU,CAACgD,YAAX,GAA0BhD,UAAU,CAAC5F,QAAX,EAA1B;EACA,eAAO2B,IAAI,CAAC4B,MAAD,CAAX;EACD,OAHwC;EAAA,KAAV;EAAA,GAA/B;;EAKA,MAAM1D,KAAK,GAAGsP,iBAAgB,CAC5BvJ,UAAU,CAACyI,SAAX,CAAqBxJ,OADO,EAE5Be,UAAU,CAACyI,SAAX,CAAqBtI,YAFO,EAG5B4I,gBAAgB,MAAhB,UACES,qBAAe,MAAf,UACEC,UADF,EAEEX,6BAFF,SAGKjB,UAHL,GAIEuB,yBAJF,EAKEE,sBALF,EAMED,qBANF,GADF,SASKzB,SATL,EAH4B,CAA9B;;EAgBA3N,EAAAA,KAAK,CAACyP,gBAAN,GAAyB;EAAA,qBAAUnB,aAAV;EAAA,GAAzB;;EACAtO,EAAAA,KAAK,CAAC0P,kBAAN,GAA2B,YAAM;EAC/BpB,IAAAA,aAAa,GAAG,EAAhB;EACD,GAFD;;EAIAvI,EAAAA,UAAU,CAACtE,QAAX,GAAsBzB,KAAK,CAACyB,QAA5B;EACAsE,EAAAA,UAAU,CAAC5F,QAAX,GAAsBH,KAAK,CAACG,QAA5B,CA5IuD;;EA+IvD,MAAMwP,kBAAkB,GAAG,SAArBA,kBAAqB,CAAArJ,cAAc,EAAI;EAC3Cc,IAAAA,MAAM,CAACC,IAAP,CAAYrH,KAAK,CAACyB,QAAlB,EAA4B6F,OAA5B,CAAoC,UAAAsI,UAAU,EAAI;EAChD,aAAO5P,KAAK,CAACyB,QAAN,CAAemO,UAAf,CAAP;EACD,KAFD;EAGAxI,IAAAA,MAAM,CAACC,IAAP,CAAYf,cAAZ,EAA4BgB,OAA5B,CAAoC,UAAAC,GAAG,EAAI;EACzCvH,MAAAA,KAAK,CAACyB,QAAN,CAAe8F,GAAf,IAAsBjB,cAAc,CAACiB,GAAD,CAApC;EACD,KAFD;;EAGAvH,IAAAA,KAAK,CAAC6P,UAAN,GAAmB;EAAA,aAAMvJ,cAAN;EAAA,KAAnB;EACD,GARD;;EAUAqJ,EAAAA,kBAAkB,CAAC5J,UAAU,CAACyI,SAAX,CAAqBlI,cAAtB,CAAlB;;EAEA,MAAMwJ,WAAW,GAAG,SAAdA,WAAc,CAAAC,SAAS,EAAI;EAC/B,QAAMhH,YAAY,GAAG/I,KAAK,CAACG,QAAN,EAArB;;EACA,QAAI4P,SAAJ,EAAe;EACb,aAAOhH,YAAY,CAACgH,SAAD,CAAnB;EACD;;EACDb,IAAAA,kBAAkB,CAAClP,KAAK,CAACG,QAAN,EAAD,CAAlB;EACAH,IAAAA,KAAK,CAACgQ,cAAN,CAAqBjK,UAAU,CAACyI,SAAX,CAAqBxJ,OAA1C;EACAhF,IAAAA,KAAK,CAACyB,QAAN,CAAe4M,YAAf,CAA4BtI,UAAU,CAACyI,SAAX,CAAqBtI,YAAjD;EACAyJ,IAAAA,kBAAkB,CAAC5J,UAAU,CAACyI,SAAX,CAAqBlI,cAAtB,CAAlB;EACD,GATD;;EAWAtG,EAAAA,KAAK,CAACiQ,QAAN,GAAiB,UAAC1I,GAAD,EAAM2I,WAAN,EAAsB;EACrC,QAAInC,eAAe,CAACxG,GAAD,CAAf,IAAwB,kBAAyB,YAArD,EAAmE;EACjE;EACArF,MAAAA,OAAO,CAACC,IAAR,4EAC0EoF,GAD1E;EAGAvH,MAAAA,KAAK,CAACmQ,WAAN,CAAkB5I,GAAlB;EACD;;EACDwG,IAAAA,eAAe,CAACxG,GAAD,CAAf,GAAuB2I,WAAvB;EACAJ,IAAAA,WAAW;EACZ,GAVD;;EAYA9P,EAAAA,KAAK,CAACmQ,WAAN,GAAoB,UAAA5I,GAAG,EAAI;EACzB,QAAI,CAACwG,eAAe,CAACxG,GAAD,CAApB,EAA2B;EACzB,MAA2C;EACzC;EACArF,QAAAA,OAAO,CAACC,IAAR,4EAC0EoF,GAD1E;EAGD;;EACD;EACD;;EACD,WAAOwG,eAAe,CAACxG,GAAD,CAAtB;EACAuI,IAAAA,WAAW,CAACvI,GAAD,CAAX;EACD,GAZD,CAlLuD;;;EAiMvD,MAAM6I,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAC3M,UAAD,EAAasE,OAAb;EAAA,WAC7B/H,KAAK,CAACyB,QAAN,CAAe;EACbwG,MAAAA,IAAI,EAAE,eADO;EAEbF,MAAAA,OAAO,EAAPA,OAFa;EAGbtE,MAAAA,UAAU,EAAVA;EAHa,KAAf,CAD6B;EAAA,GAA/B;;EAOA,MAAM4M,iBAAiB,GAAG,SAApBA,iBAAoB,CAAA3M,MAAM;EAAA,WAC9B,OAAOA,MAAP,KAAkB,UAAlB,GACIA,MAAM,CAACjB,YAAD,CAAN,GACEmI,UAAA,CAAmBlH,MAAnB,CADF,GAEEA,MAAM,CAACH,WAAD,CAAN,GACAqH,iBAAA,CAA0BlH,MAA1B,CADA,GAEApE,SALN,GAMI,OAAOoE,MAAP,KAAkB,QAAlB,GACAA,MADA,GAEApE,SAT0B;EAAA,GAAhC,CAxMuD;;;EAoNvDU,EAAAA,KAAK,CAACsQ,eAAN,GAAwB,UAACC,QAAD,EAAW7M,MAAX,EAAmBqE,OAAnB,EAA+B;EACrD,QAAMtE,UAAU,GAAG4M,iBAAiB,CAAC3M,MAAD,CAApC;;EACA,QACE6M,QAAQ,CAACxF,SAAT,CAAmBtH,UAAnB,KACA8M,QAAQ,CAACxF,SAAT,CAAmBtH,UAAnB,EAA+B/D,MAA/B,GAAwC,CAF1C,EAGE;EACA,UACE6Q,QAAQ,CAACxF,SAAT,CAAmBtH,UAAnB,EAA+B+M,IAA/B,CAAoC,UAAAvF,OAAO;EAAA,eAAIA,OAAO,CAACxI,YAAD,CAAX;EAAA,OAA3C,CADF,EAEE;EACA2N,QAAAA,sBAAsB,CAAC3M,UAAD,EAAasE,OAAb,CAAtB;EACD;;EACD,UAAM0I,aAAa,GAAGF,QAAQ,CAACxF,SAAT,CAAmBtH,UAAnB,EAA+BiN,MAA/B,CACpB,UAAAzF,OAAO;EAAA,eAAIA,OAAO,CAAC1H,WAAD,CAAX;EAAA,OADa,CAAtB;EAGA,aAAOkN,aAAa,CAAC/Q,MAAd,GAAuB,CAAvB,GACHyF,OAAO,CAACwJ,GAAR,CACE8B,aAAa,CAACxH,GAAd,CAAkB,UAAAgC,OAAO;EAAA,eAAIsD,aAAa,CAACtD,OAAD,EAAUlD,OAAV,CAAjB;EAAA,OAAzB,CADF,EAEEO,IAFF,CAEO;EAAA,eAAMhJ,SAAN;EAAA,OAFP,CADG,GAIH6F,OAAO,CAACC,OAAR,EAJJ;EAKD;;EACD,WAAOD,OAAO,CAACC,OAAR,EAAP;EACD,GArBD,CApNuD;;;EA4OvDpF,EAAAA,KAAK,CAAC2Q,gBAAN,GAAyB,UAACjN,MAAD,EAASqE,OAAT,EAAqB;EAC5C,QAAMtE,UAAU,GAAG4M,iBAAiB,CAAC3M,MAAD,CAApC;;EACA,QAAID,UAAJ,EAAgB;EACd,UAAMmN,sBAAsB,GAC1B7K,UAAU,CAACyI,SAAX,CAAqBjI,mBAArB,CAAyC9C,UAAzC,CADF;;EAEA,UAAImN,sBAAsB,IAAIA,sBAAsB,CAAClR,MAAvB,GAAgC,CAA9D,EAAiE;EAC/D0Q,QAAAA,sBAAsB,CAAC3M,UAAD,EAAasE,OAAb,CAAtB;EACD;;EACD,UAAM8I,qBAAqB,GACzB9K,UAAU,CAACyI,SAAX,CAAqBvH,kBAArB,CAAwCxD,UAAxC,CADF;EAEA,aAAOoN,qBAAqB,IAAIA,qBAAqB,CAACnR,MAAtB,GAA+B,CAAxD,GACHyF,OAAO,CAACwJ,GAAR,CACEkC,qBAAqB,CAAC5H,GAAtB,CAA0B,UAAAgC,OAAO;EAAA,eAC/BsD,aAAa,CAACtD,OAAD,EAAUlD,OAAV,CADkB;EAAA,OAAjC,CADF,EAIEO,IAJF,CAIO;EAAA,eAAMhJ,SAAN;EAAA,OAJP,CADG,GAMH6F,OAAO,CAACC,OAAR,EANJ;EAOD;;EACD,WAAOD,OAAO,CAACC,OAAR,EAAP;EACD,GAnBD;;EAqBApF,EAAAA,KAAK,CAACuB,eAAN,GAAwBA,eAAxB;EACAvB,EAAAA,KAAK,CAAC2B,gBAAN,GAAyBA,gBAAzB;EACA3B,EAAAA,KAAK,CAACH,aAAN,GAAsBA,aAAtB;EAEA,SAAOG,KAAP;EACD;;EClRD;AAEA,EAQe,SAAS8Q,kBAAT,CAA4BjL,KAA5B,EAAmCzB,MAAnC,EAA2C;EACxD,MAAM1F,YAAY,GAAGC,mBAAa,EAAlC;;EAEA,WAASoS,QAAT,OAA6C;EAAA,QAAzBC,QAAyB,QAAzBA,QAAyB;EAAA,QAAfC,WAAe,QAAfA,WAAe;EAC3C,QAAMjR,KAAK,GAAGkR,aAAO,CACnB;EAAA,aACE3D,WAAW,CACT,OAAO1H,KAAP,KAAiB,UAAjB,GAA8BA,KAAK,CAACoL,WAAD,CAAnC,GAAmDpL,KAD1C,EAETzB,MAFS,CADb;EAAA,KADmB,EAMnB,EANmB,CAArB;EAQA,WACE+M,6BAAC,YAAD,CAAc,QAAd;EAAuB,MAAA,KAAK,EAAEnR;EAA9B,OAAsCgR,QAAtC,CADF;EAGD;;EAED,WAAS1O,QAAT,GAAoB;EAClB,WAAOrC,gBAAU,CAACvB,YAAD,CAAjB;EACD;;EAED,SAAO;EACLqS,IAAAA,QAAQ,EAARA,QADK;EAELzO,IAAAA,QAAQ,EAARA,QAFK;EAGLzC,IAAAA,aAAa,EAAEF,oBAAoB,CAACjB,YAAD,CAH9B;EAIL6C,IAAAA,eAAe,EAAED,sBAAsB,CAAC5C,YAAD,CAJlC;EAKLiD,IAAAA,gBAAgB,EAAED,uBAAuB,CAAChD,YAAD;EALpC,GAAP;EAOD;;ECnCD;;;;;AAKA,EAAe,SAAS0S,oBAAT,CAA8BvL,KAA9B,EAAqCzB,MAArC,EAA6C;EAC1D,SAAO,SAASiN,aAAT,CAAuBJ,WAAvB,EAAoC;EACzC,QAAMjR,KAAK,GAAGkR,aAAO,CACnB;EAAA,aACE3D,WAAW,CACT,OAAO1H,KAAP,KAAiB,UAAjB,GAA8BA,KAAK,CAACoL,WAAD,CAAnC,GAAmDpL,KAD1C,EAETzB,MAFS,CADb;EAAA,KADmB,EAMnB,EANmB,CAArB;EAQA,QAAMkN,gBAAgB,GAAG7Q,YAAM,CAACT,KAAK,CAACG,QAAN,EAAD,CAA/B;;EATyC,oBAUDD,cAAQ,CAAC;EAAA,aAAMF,KAAK,CAACG,QAAN,EAAN;EAAA,KAAD,CAVP;EAAA,QAUlC4I,YAVkC;EAAA,QAUpBwI,eAVoB;;EAWzC3Q,IAAAA,eAAS,CAAC,YAAM;EACd,aAAOZ,KAAK,CAACoB,SAAN,CAAgB,YAAM;EAC3B,YAAMoQ,SAAS,GAAGxR,KAAK,CAACG,QAAN,EAAlB;;EACA,YAAImR,gBAAgB,CAACzQ,OAAjB,KAA6B2Q,SAAjC,EAA4C;EAC1CF,UAAAA,gBAAgB,CAACzQ,OAAjB,GAA2B2Q,SAA3B;EACAD,UAAAA,eAAe,CAACC,SAAD,CAAf;EACD;EACF,OANM,CAAP;EAOD,KARQ,EAQN,CAACxR,KAAD,CARM,CAAT;EASA,WAAO,CAAC+I,YAAD,EAAe/I,KAAK,CAACyB,QAArB,CAAP;EACD,GArBD;EAsBD;;EC3BD,IAAMgQ,aAAa,GAAG,SAAhBA,aAAgB;EAAA,MAAGT,QAAH,QAAGA,QAAH;EAAA,MAAahR,KAAb,QAAaA,KAAb;EAAA,SACpBmR,6BAAC,YAAD,CAAc,QAAd;EAAuB,IAAA,KAAK,EAAEnR;EAA9B,KAAsCgR,QAAtC,CADoB;EAAA,CAAtB;;EC0BA;;;;;;;;AAOAU,uBAAa,CAAC,KAAD,CAAb;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}